"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[913],{30913:(t,e,o)=>{o.d(e,{O5:()=>x,n$:()=>g,Iu:()=>m,D6:()=>p});var i=o(18831),r=o(28776);let l={primary:[37,99,235],primaryLight:[239,246,255],text:[31,41,55],textLight:[107,114,128],divider:[229,231,235]},s=async(t,e,i,r,l="File")=>{if(window.Capacitor||"capacitor:"===window.location.protocol)try{let s=t.output("datauristring").split(",")[1],{Filesystem:a,Directory:n}=await Promise.all([o.e(7805),o.e(8276)]).then(o.bind(o,78276)).catch(()=>({})),{Share:c}=await Promise.all([o.e(7805),o.e(8493)]).then(o.bind(o,98493)).catch(()=>({})),{LocalNotifications:h}=await Promise.all([o.e(7805),o.e(9968)]).then(o.bind(o,59968)).catch(()=>({}));try{let t=await a.requestPermissions();"granted"!==t.publicStorage&&console.warn("Storage permission not granted, falling back to app-specific storage.")}catch(t){}let d=await a.writeFile({path:e,data:s,directory:n.Downloads||n.Documents,recursive:!0});if(h)try{await h.schedule({notifications:[{title:"Download Successful",body:r||`The ${l.toLowerCase()} for "${i}" is ready.`,id:Math.floor(1e5*Math.random()),schedule:{at:new Date(Date.now()+500)},sound:null,attachments:[],smallIcon:"res://ic_stat_name",iconColor:"#2563EB"}]})}catch(t){console.error("[PDF] Notification error:",t)}if(c)try{await c.share({title:`${l} Downloaded`,text:`Successfully downloaded ${i}. Find it in your device's Downloads folder.`,url:d.uri,dialogTitle:"Share or Open Document"})}catch(t){console.error("[PDF] Share error:",t)}}catch(o){console.error("Capacitor PDF error (falling back to web save):",o),t.save(e)}else t.save(e)},a=(t,e,o)=>{t.setDrawColor(...l.divider),t.setLineWidth(.1),t.line(20,15,190,15),t.line(20,282,190,282),t.setFont("helvetica","normal"),t.setFontSize(8),t.setTextColor(...l.textLight);let i=new Date().getFullYear();t.text(`\xa9 ${i} Actinova AI Tutor - Premium Study Material`,20,287),t.text(`Page ${e} of ${o}`,190,287,{align:"right"})},n=(t,e,o,i,r,s=11,a)=>{t.setFontSize(s),t.setTextColor(...l.text);let n=e.trim().replace(/^[#\s]+/,"").replace(/\\\[(.*?)\\\]/g,"$1");return t.splitTextToSize(n,r-(o-20)).forEach(e=>{let r=.3527*s*2;i=a(r+2,i);let n=e.split(RegExp("(\\[.*?\\]\\(.*?\\)|`[^`]+`|\\*\\*.*?\\*\\*|__.*?__|(?<!\\*)\\*.*?\\*(?!\\*)|(?<!_)_.*?_(?!_)|~~.*?~~)","g")),c=o;n.forEach(e=>{let o=e.match(/^\[(.*?)\]\((.*?)\)$/);if(o){let e=o[1],r=o[2];t.setFont("helvetica","normal"),t.setTextColor(...l.primary);let a=t.getTextWidth(e);t.text(e,c,i),t.setLineWidth(.1),t.setDrawColor(...l.primary),t.line(c,i+1.5,c+a,i+1.5),t.link(c,i-s/2,a,s,{url:r}),c+=a,t.setTextColor(...l.text);return}let r=e.match(/^`([^`]+)`$/);if(r){let e=r[1];t.setFont("courier","normal");let o=t.getTextWidth(e);t.setFillColor(240,240,240),t.rect(c,i-s/1.5,o,s,"F"),t.setTextColor(220,38,38),t.text(e,c,i),c+=o,t.setFont("helvetica","normal"),t.setTextColor(...l.text);return}let a=e.startsWith("**")&&e.endsWith("**")||e.startsWith("__")&&e.endsWith("__"),n=e.startsWith("*")&&e.endsWith("*")||e.startsWith("_")&&e.endsWith("_"),h=e.startsWith("~~")&&e.endsWith("~~");if(a){t.setFont("helvetica","bold");let o=e.slice(2,-2);t.text(o,c,i),c+=t.getTextWidth(o)}else if(n){t.setFont("helvetica","italic");let o=e.slice(1,-1);t.text(o,c,i),c+=t.getTextWidth(o)}else if(h){let o=e.slice(2,-2);t.setFont("helvetica","normal"),t.text(o,c,i);let r=t.getTextWidth(o);t.setLineWidth(.2),t.setDrawColor(...l.text),t.line(c,i-.12*s,c+r,i-.12*s),c+=r}else t.setFont("helvetica","normal"),t.text(e,c,i),c+=t.getTextWidth(e)}),i+=r}),i},c=(t,e,o)=>o+e>272?(t.addPage(),25):o,h=async(t,e,o,i={})=>{let{margin:r=20,contentWidth:s=170,titleToSkip:a=null,isFirstLesson:h=!0}=i;if(!e)return o;let x=e.split("\n"),g=o,m=!1,p=[],u=[],F="",f=()=>{if(0===p.length)return;g=c(t,25,g)+5;let e=p.map(t=>t.split("|").map(t=>t.trim()).filter(t=>""!==t));if(e.length<2)return;let o=e[0],i=(s-10)/o.length;t.setFillColor(245,247,250),t.rect(r,g,s,10,"F"),t.setFont("helvetica","bold"),t.setFontSize(10),t.setTextColor(...l.text),o.forEach((e,o)=>t.text(e,r+5+o*i,g+6)),g+=10,t.setFont("helvetica","normal"),e.slice(2).forEach((e,o)=>{g=c(t,10,g),o%2==1&&(t.setFillColor(249,250,251),t.rect(r,g,s,10,"F")),e.forEach((e,o)=>{let l=t.splitTextToSize(e,i-5);t.text(l,r+5+o*i,g+6)}),t.setDrawColor(230,230,230),t.line(r,g+10,210-r,g+10),g+=10}),g+=5,p=[]};for(let e of x){let o=e.trim();if(!o&&!m){g+=6;continue}if(o.startsWith("```")){if(f(),"mermaid"===o.substring(3).trim())m="mermaid",u=[];else if("mermaid"===m){m=!1;let e=u.join("\n");if(e.trim()){let o=await d(e);if(o){let e=o.height/o.width,i=Math.min(s,.2*o.width),r=i*e;g=c(t,r+15,g),t.addImage(o.dataUrl,"PNG",(210-i)/2,g,i,r),g+=r+10}}}else m=!m;continue}if("mermaid"===m){u.push(e);continue}if(m){g=c(t,8,g),t.setFont("courier","normal"),t.setFontSize(10),t.setFillColor(248,250,252),t.rect(r+2,g-4,s-4,6,"F"),t.text(e,r+4,g),g+=6;continue}if(o.startsWith("|")&&o.endsWith("|")){p.push(o);continue}if(f(),g=c(t,12,g),(o.startsWith("# ")||o.startsWith("## "))&&(F=o.replace(/^#+\s*/,"").replace(/[\*_]/g,"").trim()),o.startsWith("# ")){let e=o.substring(2).replace(/[\*_]/g,"").trim();if(a&&e.toLowerCase().includes(a.toLowerCase())&&h)continue;g+=10,t.setFont("helvetica","bold"),t.setFontSize(26),t.setTextColor(...l.primary),t.text(e,r,g),g+=10,t.setDrawColor(...l.primary),t.setLineWidth(.8),t.line(r,g-7,r+t.getTextWidth(e),g-7),g+=5}else if(o.startsWith("## ")){g+=10,t.setFont("helvetica","bold"),t.setFontSize(20),t.setTextColor(...l.primary);let e=o.substring(3).replace(/[\*_]/g,"").trim();t.text(e,r,g),g+=8,t.setDrawColor(...l.primaryLight),t.setLineWidth(.4),t.line(r,g-6,r+s,g-6),g+=4}else if(o.startsWith("### ")){g+=5,t.setFont("helvetica","bold"),t.setFontSize(16),t.setTextColor(...l.text);let e=o.substring(4).replace(/[\*_]/g,"").trim();t.text(e,r,g),g+=8}else if(o.startsWith("#### ")){g+=10/3,t.setFont("helvetica","bold"),t.setFontSize(13),t.setTextColor(...l.text);let e=o.substring(5).replace(/[\*_]/g,"").trim();t.text(e,r,g),g+=6}else if(o.startsWith("##### ")){g+=2.5,t.setFont("helvetica","bold"),t.setFontSize(11),t.setTextColor(...l.text);let e=o.substring(6).replace(/[\*_]/g,"").trim();t.text(e,r,g),g+=5}else if(o.startsWith("###### ")){g+=2,t.setFont("helvetica","bold"),t.setFontSize(10),t.setTextColor(...l.text);let e=o.substring(7).replace(/[\*_]/g,"").trim();t.text(e,r,g),g+=4}else if(o.startsWith("> ")){let e=o.substring(2).trim();t.setFont("helvetica","italic"),t.setTextColor(...l.textLight);let i=t.splitTextToSize(e,s-15);g=c(t,8*i.length+5,g),t.setDrawColor(...l.primary),t.setLineWidth(1.5),t.line(r+2,g-4,r+2,g+8*i.length-4),i.forEach(e=>{t.text(e,r+8,g),g+=8}),g+=5}else if(o.match(/^[-*•]\s/))F.toLowerCase().includes("practice exercises")?(t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("✓",r+2,g),g=n(t,o.replace(/^[-*•]\s/,""),r+10,g,s,11,(e,o)=>c(t,e,o))):(t.setFont("helvetica","bold"),t.setTextColor(...l.primary),t.text("•",r+2,g),g=n(t,o.replace(/^[-*•]\s/,""),r+8,g,s,11,(e,o)=>c(t,e,o)));else if(o.match(/^\d+\.\s/)){let e=o.match(/^\d+\./)[0];t.setFont("helvetica","bold"),t.setTextColor(...l.primary),t.text(e,r,g),g=n(t,o.replace(/^\d+\.\s/,""),r+10,g,s,11,(e,o)=>c(t,e,o))}else g=e.startsWith("    ")||e.startsWith("	")?n(t,o,r+10,g,s,11,(e,o)=>c(t,e,o)):n(t,o,r,g,s,11,(e,o)=>c(t,e,o))}return f(),g},d=async t=>{try{let e=t.replace(/\[([\s\S]*?)\]/g,(t,e)=>/[()",]/.test(e)?`["${e.trim().replace(/"/g,'""')}"]`:t),o=`mermaid-pdf-${Date.now()}-${Math.floor(1e4*Math.random())}`;r.A.initialize({startOnLoad:!1,theme:"default"});let{svg:i}=await r.A.render(o,e);return new Promise(t=>{let e=new Image,o=btoa(unescape(encodeURIComponent(i))),r=`data:image/svg+xml;base64,${o}`;e.onload=()=>{let o=document.createElement("canvas");o.width=3*e.width,o.height=3*e.height;let i=o.getContext("2d");i.fillStyle="#ffffff",i.fillRect(0,0,o.width,o.height),i.scale(3,3),i.drawImage(e,0,0),t({dataUrl:o.toDataURL("image/png"),width:e.width,height:e.height})},e.onerror=()=>t(null),e.src=r})}catch(t){return console.error("Mermaid render error:",t),null}},x=async t=>{if(!t)throw Error("No data provided");let e=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=30;e.setFillColor(...l.primaryLight),e.rect(0,0,210,297,"F");try{e.addImage("/logo.png","PNG",80,o,50,50),o+=70}catch(t){o+=30}e.setFont("helvetica","bold"),e.setFontSize(40),e.setTextColor(...l.primary),e.text("ACTINOVA",105,o,{align:"center"}),o+=15,e.setFontSize(18),e.setTextColor(...l.textLight),e.text("AI Tutor Platform",105,o,{align:"center"}),o=140,e.setFillColor(255,255,255),e.setDrawColor(...l.primary),e.setLineWidth(2),e.roundedRect(20,o,170,80,10,10,"FD"),e.setTextColor(...l.primary),e.setFontSize(32);let r=e.splitTextToSize(t.title||"Full Course Material",130);e.text(r,105,o+30,{align:"center"}),e.setFontSize(14),e.setTextColor(...l.textLight),e.text("Personalized Course Textbook",105,o+60,{align:"center"}),e.text(`Generated: ${new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}`,105,o+75,{align:"center"}),e.addPage(),o=40;let n=t.modules||t.courseData?.modules||[];e.setFont("helvetica","bold"),e.setFontSize(28),e.setTextColor(...l.primary),e.text("Table of Contents",20,o),o+=20,n.forEach((t,i)=>{o=c(e,20,o),e.setFontSize(16),e.setTextColor(...l.text),e.text(`Module ${i+1}: ${t.title}`,20,o),o+=12,t.lessons&&t.lessons.forEach((t,r)=>{o=c(e,10,o),e.setFontSize(12),e.setTextColor(...l.textLight),e.text(`  ${i+1}.${r+1}  ${t.title||"Untitled Lesson"}`,25,o),o+=8}),o+=8});for(let t=0;t<n.length;t++){let i=n[t];e.addPage(),o=40,e.setFont("helvetica","bold"),e.setFontSize(34),e.setTextColor(...l.primary),e.text(`MODULE ${t+1}`,20,o),o+=18,e.setFontSize(24),e.setTextColor(...l.text);let r=e.splitTextToSize(i.title.toUpperCase(),170);if(e.text(r,20,o),o+=12*r.length+20,i.lessons)for(let r=0;r<i.lessons.length;r++){let s=i.lessons[r];o=c(e,50,o),e.setFont("helvetica","bold"),e.setFontSize(20),e.setTextColor(...l.primary);let a=`${t+1}.${r+1} ${s.title||"Lesson"}`,n=e.splitTextToSize(a,170);e.text(n,20,o),o+=10*n.length+15,s.content&&(o=await h(e,s.content,o,{titleToSkip:s.title,isFirstLesson:!0})),o+=20}}let d=e.getNumberOfPages();for(let t=1;t<=d;t++)e.setPage(t),a(e,t,d);let x=`${(t.title||"course").replace(/\s+/g,"_").toLowerCase()}.pdf`;await s(e,x,t.title,`Your full course textbook "${t.title}" is ready.`,"Course")},g=async t=>{if(!t||!t.content)throw Error("No content provided");let e=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=25;e.setFillColor(255,255,255),e.rect(0,0,210,297,"F"),o=40;try{e.addImage("/logo.png","PNG",85,o,40,40),o+=45}catch(t){o=80}o+=16,e.setTextColor(...l.text),e.setFont("helvetica","bold"),e.setFontSize(40),e.text("STUDY NOTES",105,o,{align:"center"}),o=150;let r=e.splitTextToSize(t.title||"Lesson Material",130),n=40+12*r.length+20;e.setDrawColor(...l.primary),e.setLineWidth(.5),e.roundedRect(20,o-15,170,n,2,2,"D"),e.setTextColor(...l.primary),e.setFontSize(14),e.text("PERSONALIZED ACADEMIC CONTENT",105,o,{align:"center"}),o+=15,e.setTextColor(...l.text),e.setFontSize(28),e.text(r,105,o,{align:"center",maxWidth:130}),o+=12*r.length+10,e.setFontSize(12),e.setTextColor(...l.textLight),e.text(`Generated on ${new Date().toLocaleDateString()}`,105,o,{align:"center"}),e.addPage(),o=30,e.setFont("helvetica","bold"),e.setFontSize(22),e.setTextColor(...l.primary);let c=e.splitTextToSize(t.title||"Lesson Material",170);e.text(c,20,o),o+=8*c.length+6,o=await h(e,t.content,o,{titleToSkip:t.title,isFirstLesson:!0});let d=e.internal.pages.length-1;for(let t=1;t<=d;t++)e.setPage(t),a(e,t,d);let x=`${t.title?.replace(/\s+/g,"_").toLowerCase()||"lesson"}.pdf`;await s(e,x,t.title,"Your lesson notes are ready.","Lesson")},m=async t=>{if(!t||!t.questions)throw Error("No data provided");let e=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=40,r=(o,i)=>{e.setDrawColor(...l.divider),e.setLineWidth(.1),e.line(20,15,190,15),e.setFontSize(8),e.setTextColor(...l.textLight),e.text(`Actinova AI Tutor - Assessment: ${t.title}`,20,12),o&&e.text(`Page ${o} of ${i}`,190,12,{align:"right"})};r(),e.setFont("helvetica","bold"),e.setFontSize(24),e.setTextColor(...l.primary),e.text("ASSESSMENT PAPER",105,o,{align:"center"}),o+=12,e.setFontSize(14),e.setTextColor(...l.textLight),e.text(`Subject: ${t.topic||"General Knowledge"}`,105,o,{align:"center"}),o+=20,t.questions.forEach((t,i)=>{let r=e.splitTextToSize(`${i+1}. ${t.text}`,160),s=8*(t.options?.length||0);o=c(e,6*r.length+s+20,o),e.setFont("helvetica","bold"),e.setFontSize(12),e.setTextColor(...l.text),e.text(r,20,o),o+=6*r.length+4,t.options&&(e.setFont("helvetica","normal"),e.setFontSize(11),t.options.forEach((t,i)=>{e.setTextColor(...l.textLight),e.text(String.fromCharCode(65+i)+")",25,o),e.setTextColor(...l.text),e.text(e.splitTextToSize(t,150),35,o),o+=8})),o+=6}),e.addPage(),r(),o=30,e.setFont("helvetica","bold"),e.setFontSize(18),e.setTextColor(...l.primary),e.text("ANSWER KEY",20,o),o+=15,e.setFontSize(11),t.questions.forEach((t,i)=>{o=c(e,10,o),e.setFont("helvetica","bold"),e.setTextColor(...l.text),e.text(`${i+1}: `,20,o),e.setFont("helvetica","normal"),e.setTextColor(...l.primary),e.text(String(t.correctAnswer),30,o),o+=10});let a=e.internal.pages.length-1;for(let t=1;t<=a;t++)e.setPage(t),r(t,a);let n=`assessment_${t.title?.replace(/\s+/g,"_").toLowerCase()||"exam"}.pdf`;await s(e,n,t.title,"Assessment downloaded successfully.","Assessment")},p=async(t,e="Scholar")=>{if(!t)throw Error("No data provided");let o=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),r=30;o.setFontSize(70),o.setTextColor(240,240,240),o.text("ACTINOVA",105,160,{align:"center"});try{o.addImage("/logo.png","PNG",85,r,40,40),r+=55}catch(t){r+=10}o.setFillColor(...l.primary),o.rect(20,r,170,15,"F"),o.setFont("helvetica","bold"),o.setFontSize(18),o.setTextColor(255,255,255),o.text("PAYMENT RECEIPT",105,r+10,{align:"center"}),r+=30,o.setTextColor(...l.text),o.setFontSize(22),o.text("Actinova AI Tutor",105,r,{align:"center"}),r+=12,o.setFontSize(12),o.setTextColor(...l.textLight),o.text("Your Intelligent Learning Companion",105,r,{align:"center"}),r+=20,o.setFontSize(12),o.setTextColor(...l.text),o.text(`Billed to: ${e}`,105,r,{align:"center"}),r+=20,o.setFont("helvetica","bold"),o.setFontSize(16),o.text("Thank you for your subscription!",105,r,{align:"center"}),r+=25;let a=new Date(t.date||t.paidAt||Date.now()).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});o.setFontSize(11),o.setFont("helvetica","bold"),o.text("Date:",30,r),o.text(a,70,r),o.text("Plan:",115,r),o.text(t.plan||"Pro",145,r),r+=10,o.text("Receipt #:",30,r),o.text(t.reference?.toUpperCase()||"N/A",70,r),o.text("Status:",115,r),o.setTextColor(...l.success),o.text("PAID",145,r),r+=20,o.setFontSize(20),o.setTextColor(...l.primary);let n=new Intl.NumberFormat("en-US",{style:"currency",currency:t.currency||"USD"}).format(t.amount||0);o.text(`Amount: ${n}`,105,r,{align:"center"}),r+=30,o.setFontSize(10),o.setTextColor(...l.textLight),o.text("This is an official receipt. Contact support@actinova.ai for questions.",105,r,{align:"center"});let c=`receipt-${t.reference||"payment"}.pdf`;await s(o,c,"Subscription Payment","Your receipt has been downloaded.","Receipt")}}}]);