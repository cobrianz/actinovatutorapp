"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8126],{98126:(t,e,o)=>{o.d(e,{Iu:()=>h,O5:()=>c});var i=o(18831);let l=[37,99,235],a=[31,41,55],r=[107,114,128],s=[229,231,235],n=async(t,e,i)=>{try{let l,a,{Filesystem:r,Directory:s}=await Promise.all([o.e(7805),o.e(8276)]).then(o.bind(o,78276)).catch(()=>({})),{Share:n}=await Promise.all([o.e(7805),o.e(8493)]).then(o.bind(o,98493)).catch(()=>({})),{LocalNotifications:c}=await Promise.all([o.e(7805),o.e(9968)]).then(o.bind(o,59968)).catch(()=>({}));if(!r||!n||!c)throw Error("Capacitor plugins not available");try{await c.requestPermissions()}catch(t){console.warn("Notification permissions denied",t)}try{try{await r.mkdir({path:"Download/Actinova",directory:s.ExternalStorage,recursive:!0})}catch(t){}l=await r.writeFile({path:`Download/Actinova/${t}`,data:e,directory:s.ExternalStorage}),a="Downloads/Actinova"}catch(o){console.warn("ExternalStorage write failed, falling back to Documents",o);try{await r.mkdir({path:"Actinova",directory:s.Documents,recursive:!0})}catch(t){}l=await r.writeFile({path:`Actinova/${t}`,data:e,directory:s.Documents}),a="Documents/Actinova"}await c.schedule({notifications:[{title:"Download Successful",body:`${i} saved to ${a}.`,id:Math.floor(1e5*Math.random()),schedule:{at:new Date(Date.now()+100)},sound:null,attachments:null,actionTypeId:"",extra:null}]}),await n.share({title:"Actinova Download",text:`Here is your file: ${i}`,url:l.uri,dialogTitle:"Open File"})}catch(i){console.error("Mobile save failed:",i);let o=document.createElement("a");o.href=`data:application/pdf;base64,${e}`,o.download=t,o.click()}},c=async(t,e="course")=>{if(!t)throw Error("No data provided");let o=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),c=25,h=(t,e)=>{o.setDrawColor(...s),o.setLineWidth(.2),o.line(20,15,190,15),o.line(20,282,190,282),o.setFont("helvetica","normal"),o.setFontSize(8),o.setTextColor(...r),o.text("Actinova AI Tutor - Personalized Learning",20,287),o.text("Copyright \xa9 Actinova AI Tutor. All rights reserved.",105,287,{align:"center"}),o.text(`Page ${t} of ${e}`,190,287,{align:"right"})},d=t=>c+t>272&&(o.addPage(),c=25,!0);o.setFillColor(255,255,255),o.rect(0,0,210,297,"F"),c=40;try{o.addImage("/logo.png","PNG",85,c,40,40),c+=45}catch(t){c=80}c+=16,o.setTextColor(...a),o.setFont("helvetica","bold"),o.setFontSize(48),o.text("ACTINOVA",105,c,{align:"center"}),c+=12,o.setFontSize(24),o.text("AI TUTOR PLATFORM",105,c,{align:"center"}),c=150;let g=o.splitTextToSize(t.title||"Study Material",150),x=12*g.length;o.setDrawColor(...l),o.setLineWidth(.5),o.roundedRect(15,c-15,180,40+x+20,2,2,"D"),o.setTextColor(...l),o.setFontSize(14),o.text("NOTES"===e.toUpperCase()?"PERSONALIZED STUDY NOTES":"PERSONALIZED COURSE MATERIAL",105,c,{align:"center"}),c+=15,o.setTextColor(...a),o.setFontSize(28),o.text(g,105,c,{align:"center"}),c+=12*g.length+10,o.setFontSize(12),o.setTextColor(...r),o.text(`Generated on ${new Date().toLocaleDateString()}`,105,c,{align:"center"}),o.addPage(),c=30;let p=(t,e,i=11)=>{o.setFontSize(i),o.setFont("helvetica","normal"),o.setTextColor(...a);let l=t.replace(/\*\*\*([^*]+)\*\*\*/g,"$1").replace(/\*\*([^*]+)\*\*/g,"$1").replace(/\*([^*]+)\*/g,"$1").replace(/__([^_]+)__/g,"$1").replace(/_([^_]+)_/g,"$1").replace(/~~([^~]+)~~/g,"$1").replace(/`([^`]+)`/g,"$1").trim();o.splitTextToSize(l,170-(e-20)).forEach(t=>{d(8),o.text(t,e,c),c+=7})},u=(t,e=null)=>{if(!t)return;let i=t.split("\n"),n=!1,h=!1,g=!0;i.forEach(t=>{let i=t.trim();if(i.startsWith("```")){n=!n,c+=2,g=!1;return}if(n){o.setFont("courier","normal"),o.setFontSize(10),o.setFillColor(245,245,245),o.rect(22,c-4,166,6,"F"),o.text(t,24,c),c+=6,o.setFont("helvetica","normal"),g=!1;return}if(["---","***","___"].includes(i)){d(10),c+=5,o.setDrawColor(...s),o.setLineWidth(.5),o.line(20,c,190,c),c+=8,g=!1;return}if(!i){c+=5,g=!1;return}if(d(12),i.startsWith("# Module: ")||i.startsWith("MODULE: ")||i.startsWith("Module: ")){g=!1;return}if(i.startsWith("## LESSON: ")||i.startsWith("LESSON: ")||i.startsWith("Lesson: ")){c+=5,o.setFont("helvetica","bold"),o.setFontSize(20),o.setTextColor(...l);let t=i.replace(/^##\s*/,"").replace(/^LESSON:\s*/i,"");t=t.toUpperCase();let e=o.splitTextToSize(t,170);o.text(e,20,c),c+=10*e.length;let a=o.getTextWidth(e[e.length-1]);o.setDrawColor(...l),o.setLineWidth(.8),o.line(20,c-2,20+a,c-2),c+=5,g=!1;return}if(g&&!i.startsWith("#")&&!i.startsWith("##")&&!i.startsWith("###")&&!i.startsWith("> ")&&!i.match(/^[-*•]\s/)&&!i.match(/^\d+\.\s/)){c+=5,o.setFont("helvetica","bold"),o.setFontSize(26),o.setTextColor(...l);let t=o.splitTextToSize(i,160);o.text(t,20,c),c+=12*t.length+8,g=!1;return}if(g=!1,i.startsWith("# ")){let t=i.substring(2).replace(/[\*_]/g,"").trim();if(!h&&e&&t.toLowerCase().includes(e.toLowerCase())){h=!0;return}c+=5,o.setFont("helvetica","bold"),o.setFontSize(26),o.setTextColor(...l);let a=o.splitTextToSize(t,170);o.text(a,20,c),c+=12*a.length+8}else if(i.startsWith("## ")){c+=5,o.setFont("helvetica","bold"),o.setFontSize(20),o.setTextColor(...l);let t=i.substring(3).replace(/[\*_]/g,"").trim(),e=o.splitTextToSize(t,170);o.text(e,20,c),c+=10*e.length;let a=o.getTextWidth(e[e.length-1]);o.setDrawColor(...l),o.setLineWidth(.8),o.line(20,c-2,20+a,c-2),c+=5}else if(i.startsWith("### ")){c+=4,o.setFont("helvetica","bold"),o.setFontSize(16),o.setTextColor(...a);let t=i.substring(4).replace(/[\*_]/g,"").trim(),e=o.splitTextToSize(t,170);o.text(e,20,c),c+=9*e.length+4}else if(i.startsWith("#### ")){c+=3,o.setFont("helvetica","bold"),o.setFontSize(14),o.setTextColor(...a);let t=i.substring(5).replace(/[\*_]/g,"").trim(),e=o.splitTextToSize(t,170);o.text(e,20,c),c+=8*e.length+3}else if(i.startsWith("> ")){let t=i.substring(2).trim();o.setFont("helvetica","italic"),o.setTextColor(...r);let e=o.splitTextToSize(t,160);d(6*e.length+4),o.setDrawColor(...s),o.setLineWidth(1),o.line(22,c-4,22,c+6*e.length-4),o.text(e,28,c),c+=6*e.length+4,o.setFont("helvetica","normal")}else if(i.match(/^[-*•]\s/))o.setFont("helvetica","bold"),o.setTextColor(...l),o.text("•",22,c),p(i.replace(/^[-*•]\s/,""),28);else if(i.match(/^\d+\.\s/)){let t=i.match(/^\d+\./)[0];o.setFont("helvetica","bold"),o.setTextColor(...l),o.text(t,20,c),p(i.replace(/^\d+\.\s/,""),30)}else p(i,20)})};if("course"===e){let e=t.modules||t.courseData?.modules||[];o.setFont("helvetica","bold"),o.setFontSize(24),o.setTextColor(...l),o.text("Table of Contents",20,c),c+=15,e.forEach((t,e)=>{d(12),o.setFontSize(12),o.setFont("helvetica","normal"),o.setTextColor(...a),o.text(`Module ${e+1}: ${t.title}`,20,c),c+=8}),e.forEach((t,e)=>{o.addPage(),c=35,t.lessons?.forEach((t,i)=>{d(20),o.setFont("helvetica","bold"),o.setFontSize(16),o.setTextColor(...a),o.text(`${e+1}.${i+1} ${t.title||t}`,20,c),c+=12,t.content&&u(t.content,t.title||t),c+=10})})}else u(t.content,t.title);let T=o.internal.pages.length-1;for(let t=1;t<=T;t++)o.setPage(t),h(t,T);let S=`${t.title?.replace(/\s+/g,"_").toLowerCase()||"actinova_study"}.pdf`;if(window.Capacitor||"capacitor:"===window.location.protocol){let e=o.output("datauristring").split(",")[1];await n(S,e,t.title)}else o.save(S)},h=async t=>{if(!t||!t.questions)throw Error("No data provided");let e=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=40,c=(o,i)=>{e.setDrawColor(...s),e.setLineWidth(.2),e.line(20,15,190,15),e.setFontSize(8),e.setTextColor(...r),e.text(`Actinova AI Tutor - Assessment: ${t.title}`,20,12),o&&e.text(`Page ${o} of ${i}`,190,12,{align:"right"})};c(),e.setFont("helvetica","bold"),e.setFontSize(24),e.setTextColor(...l),e.text("ASSESSMENT PAPER",105,o,{align:"center"}),o+=12,e.setFontSize(14),e.setTextColor(...r),e.text(`Subject: ${t.topic||"General Knowledge"}`,105,o,{align:"center"}),o+=20,e.setDrawColor(...l),e.setLineWidth(1),e.line(20,o,190,o),o+=15,t.questions.forEach((t,i)=>{let l=e.splitTextToSize(`${i+1}. ${t.text}`,160),n=8*(t.options?.length||0);o+6*l.length+n+20>267&&(e.addPage(),c(),o=25),e.setFont("helvetica","bold"),e.setFontSize(12),e.setTextColor(...a),e.text(l,20,o),o+=6*l.length+5,t.options?(e.setFont("helvetica","normal"),e.setFontSize(11),t.options.forEach((t,i)=>{e.setTextColor(...r),e.text(String.fromCharCode(65+i)+")",25,o),e.setTextColor(...a),e.text(e.splitTextToSize(t,150),35,o),o+=8})):(e.setDrawColor(...s),e.line(25,o+5,185,o+5),o+=15),o+=10}),e.addPage(),c(),o=30,e.setFont("helvetica","bold"),e.setFontSize(18),e.setTextColor(...l),e.text("ANSWER KEY",20,o),o+=15,e.setFontSize(11),t.questions.forEach((t,i)=>{o>277&&(e.addPage(),c(),o=25),e.setFont("helvetica","bold"),e.setTextColor(...a),e.text(`${i+1}: `,20,o),e.setFont("helvetica","normal"),e.setTextColor(...l),e.text(String(t.correctAnswer),30,o),o+=8});let h=e.internal.pages.length-1;for(let t=1;t<=h;t++)e.setPage(t),c(t,h);let d=`assessment_${t.title?.replace(/\s+/g,"_").toLowerCase()||"exam"}.pdf`;if(window.Capacitor||"capacitor:"===window.location.protocol){let o=e.output("datauristring").split(",")[1];await n(d,o,t.title)}else e.save(d)}}}]);