"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8413],{18413:(e,r,t)=>{t.d(r,{A:()=>f});var a=t(95155),s=t(12115),o=t(73321),n=t(31885),l=t(48368),i=t(13535),d=t(94961),c=t(66088),g=t(41585),u=t(86901),x=t(66609),m=t(5669),h=t(28393),p=t(75238),b=t(99776);function f({setActiveContent:e}){let[r,t]=(0,s.useState)(""),[f,v]=(0,s.useState)("course"),[w,j]=(0,s.useState)("beginner"),[k,N]=(0,s.useState)(10),[E,z]=(0,s.useState)(!1),[q,A]=(0,s.useState)(null),[P,S]=(0,s.useState)(!1),C=(0,o.useRouter)(),{user:$,loading:F,refreshToken:I}=(0,h.h)();s.useEffect(()=>()=>{if(E){console.log("Generate cleanup: clearing showLoader on unmount");try{z(!1)}catch(e){console.warn("Failed to clear showLoader during cleanup",e)}}},[]);let U=(0,o.usePathname)();s.useEffect(()=>{z(!1)},[U]),s.useEffect(()=>{let e=()=>{E&&(console.log("Generate: received actinova:loading-done, clearing showLoader"),z(!1))};return window.addEventListener("actinova:loading-done",e),()=>{window.removeEventListener("actinova:loading-done",e)}},[E]);let D=($?.subscription?.plan==="pro"||$?.subscription?.plan==="enterprise")&&$?.subscription?.status==="active"||!!$?.isPremium,L=!!($?.usage?.isAtLimit||!D&&$?.usage?.remaining===0),_=!F&&$&&($.firstName||$.name.split(" ")[0])||"",O=async(a=0)=>{if(!r.trim()||P)return;S(!0);let s=r.trim(),o=`generated_${s}_${f}_${w}`;try{if(localStorage.getItem(o))return void C.push(`/learn/content?topic=${encodeURIComponent(s)}&format=${f}&difficulty=${w}`)}catch{}if("flashcards"===f){console.log("Generate: showing loader for flashcard generation"),z(!0),S(!0);try{let r=await (0,m.Ud)("/api/generate-flashcards",{method:"POST",body:JSON.stringify({topic:s,difficulty:w})});if(!r.ok){let e={};try{e=await r.json()}catch(e){throw Error(`Server Error (${r.status}): Request failed`)}if(429===r.status)return void x.toast.error("Monthly limit reached. Upgrade to Pro for more!");throw Error(e.error||"Failed to generate flashcards")}await r.json(),window.dispatchEvent(new Event("usageUpdated")),x.toast.success("Flashcards generated successfully!"),e("flashcards")}catch(e){console.error("Flashcard generation failed:",e),x.toast.error(e.message||"Failed to generate flashcards")}finally{z(!1),S(!1)}return}if("quiz"===f){console.log("Generate: showing loader for quiz generation"),z(!0);try{let e=await (0,m.Ud)("/api/generate-course",{method:"POST",body:JSON.stringify({topic:s,difficulty:w,format:"quiz",questions:k})});if(!e.ok){let r={};try{r=await e.json()}catch(r){throw Error(`Server Error (${e.status}): Request failed`)}if(429===e.status)return void x.toast.error("Monthly limit reached. Upgrade to Pro for more!");throw Error(r.error||"Failed to generate quiz")}let r=await e.json();A({_id:r.quizId,...r.content}),x.toast.success("Quiz generated successfully!"),window.dispatchEvent(new Event("usageUpdated")),t("")}catch(e){console.error("Quiz generation failed:",e),x.toast.error(e.message||"Failed to generate quiz")}finally{console.log("Generate: hiding loader (quiz flow)"),z(!1),S(!1)}return}C.push(`/learn/content?topic=${encodeURIComponent(s)}&format=${f}&difficulty=${w}`)};return(s.useEffect(()=>{q&&e("quizzes")},[q,e]),q)?(0,a.jsx)(b.A,{quizData:q,topic:q.course,onBack:()=>A(null),existingQuizId:q._id}):(0,a.jsxs)("div",{className:"space-y-6",children:[E&&(0,a.jsx)("div",{"data-actinova-loader-overlay":"true",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:(0,a.jsx)(p.A,{text:f})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("h1",{className:"text-4xl sm:text-5xl font-black bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 bg-clip-text text-transparent mb-4",children:_?`Welcome, ${_}`:"Actinova AI Tutor"})}),(0,a.jsxs)("div",{className:"p-6 sm:p-8 shadow-sm",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"What can I help you learn today?"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Enter a topic below to generate a personalized content"}),!D&&L&&(0,a.jsx)("div",{className:"mt-4 mx-auto max-w-md p-3 rounded-lg border border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-200 text-sm",children:"You hit free limits. Upgrade to get more generations."})]}),(0,a.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"relative group p-[2px] rounded-xl sm:rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 shadow-sm focus-within:shadow-indigo-500/20 transition-all duration-300",children:(0,a.jsx)("textarea",{value:r,onChange:e=>{t(e.target.value),e.target.style.height="auto",e.target.style.height=Math.min(e.target.scrollHeight,200)+"px"},placeholder:"Ex: Advanced Quantum Physics concepts or Basic French for travelers",className:"w-full px-3 sm:px-4 py-3 sm:py-4 text-base sm:text-lg border-none rounded-lg sm:rounded-[14px] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-0 transition-all duration-200 resize-none min-h-[100px] sm:min-h-[120px] max-h-[200px]",onKeyDown:e=>{"Enter"===e.key&&e.ctrlKey&&(e.preventDefault(),O())},autoFocus:!0,rows:4,maxLength:500,dir:"ltr",style:{direction:"ltr",unicodeBidi:"plaintext"}})}),(0,a.jsxs)("div",{className:"mt-2 flex justify-between items-center text-xs text-gray-500 dark:text-gray-400 px-1",children:[(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(n.A,{className:"w-4 h-4 mr-1"}),"Tip: You can describe your course."]}),(0,a.jsxs)("span",{className:r.length>450?"text-orange-500":"",children:[r.length,"/500"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[10px] font-black text-gray-500 dark:text-gray-400 mb-4 px-1",children:"Choose the format"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3 sm:gap-4",children:[(0,a.jsxs)("button",{onClick:()=>v("course"),className:`p-4 rounded-xl border-2 transition-all flex flex-col items-center justify-center group h-full ${"course"===f?"border-blue-600 bg-blue-600 shadow-lg shadow-blue-500/30 text-white":"border-gray-100 dark:border-gray-700 hover:border-blue-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}`,children:[(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)(l.A,{className:"w-8 h-8",strokeWidth:"course"===f?2.5:2})}),(0,a.jsx)("span",{className:"font-bold text-xs sm:text-sm",children:"Course"})]}),(0,a.jsxs)("button",{onClick:()=>v("flashcards"),className:`p-4 rounded-xl border-2 transition-all flex flex-col items-center justify-center group h-full ${"flashcards"===f?"border-purple-600 bg-purple-600 shadow-lg shadow-purple-500/30 text-white":"border-gray-100 dark:border-gray-700 hover:border-purple-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}`,children:[(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)(i.A,{className:"w-8 h-8",strokeWidth:"flashcards"===f?2.5:2})}),(0,a.jsx)("span",{className:"font-bold text-xs sm:text-sm",children:"Flashcards"})]}),(0,a.jsxs)("button",{onClick:()=>v("quiz"),className:`p-4 rounded-xl border-2 transition-all flex flex-col items-center justify-center group h-full ${"quiz"===f?"border-emerald-600 bg-emerald-600 shadow-lg shadow-emerald-500/30 text-white":"border-gray-100 dark:border-gray-700 hover:border-emerald-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}`,children:[(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)(d.A,{className:"w-8 h-8",strokeWidth:"quiz"===f?2.5:2})}),(0,a.jsx)("span",{className:"font-bold text-xs sm:text-sm",children:"Test Yourself"})]})]})]}),"quiz"===f&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 text-left",children:"Number of questions (up to 50)"}),(0,a.jsx)("input",{type:"number",value:k,onChange:e=>N(Math.min(50,parseInt(e.target.value,10)||10)),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400",max:"50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-[10px] font-black text-gray-500 dark:text-gray-400 mb-4 px-1",children:["Choose difficulty level",!D&&(0,a.jsx)("span",{className:"ml-2 text-[10px] text-orange-600 dark:text-orange-400 normal-case tracking-normal",children:"(Free users: Beginner only)"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("select",{value:w,onChange:r=>{let t=r.target.value;if(!D&&"beginner"!==t){x.toast.error("Intermediate and Advanced levels require Pro subscription. Please upgrade to continue."),e("upgrade");return}j(t)},className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 appearance-none pr-10",disabled:!D&&L,children:[(0,a.jsxs)("option",{value:"beginner",children:["Beginner"," ",D?"":"(Free)"]}),(0,a.jsxs)("option",{value:"intermediate",disabled:!D,children:["Intermediate"," ",D?"(Pro)":"(Pro Only)"]}),(0,a.jsxs)("option",{value:"advanced",disabled:!D,children:["Advanced"," ",D?"(Pro)":"(Pro Only)"]})]}),(0,a.jsx)(c.A,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"})]}),!D&&"beginner"!==w&&(0,a.jsx)("div",{className:"mt-2 p-3 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-xl",children:(0,a.jsxs)("p",{className:"text-sm text-orange-800 dark:text-orange-200 flex items-start",children:[(0,a.jsx)(g.A,{className:"w-4 h-4 mr-2 mt-0.5 flex-shrink-0"}),"Intermediate and Advanced levels require a Pro subscription.",(0,a.jsx)("button",{onClick:()=>e("upgrade"),className:"ml-1 font-semibold underline hover:text-orange-900 dark:hover:text-orange-100",children:"Upgrade to Pro"})]})})]}),(0,a.jsxs)("button",{onClick:O,disabled:!r.trim()||!!$&&!D&&L,className:"w-full bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 text-white py-4 px-6 rounded-xl font-black text-sm hover:brightness-110 active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 shadow-xl shadow-indigo-500/20",children:[(0,a.jsx)(u.A,{className:"w-5 h-5 animate-pulse"}),(0,a.jsx)("span",{children:!D&&L?"Update to Pro for more":"Generate Now"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-[10px] font-black text-gray-500 dark:text-gray-400 mb-4 px-1",children:"Popular Learning Tracks"}),(0,a.jsx)(y,{setTopic:t})]})]})}function y({setTopic:e}){let[r,t]=s.useState([]),[o,n]=s.useState(!0);return(s.useEffect(()=>{!async function(){try{let e=await (0,m.Ud)("/api/popular-topics"),r=await e.json();t(r.topics||[])}catch(e){t(["Artificial Intelligence","Frontend Development","Backend Development","Data Science","Machine Learning","Web Development","Mobile Development","DevOps"])}finally{n(!1)}}()},[]),o)?(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2 sm:gap-3",children:[...Array(8)].map((e,r)=>(0,a.jsx)("div",{className:"p-3 sm:p-4 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg animate-pulse",children:(0,a.jsx)("div",{className:"h-4 bg-gray-300 dark:bg-gray-600 rounded w-3/4"})},r))}):(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2 sm:gap-3",children:r.map(r=>(0,a.jsx)("button",{onClick:()=>{e(r)},className:"p-4 text-left bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 hover:border-indigo-300 dark:hover:border-indigo-700 rounded-xl hover:shadow-lg hover:shadow-indigo-500/5 transition-all group active:scale-95",children:(0,a.jsx)("span",{className:"text-xs sm:text-sm font-bold text-gray-700 dark:text-gray-200 line-clamp-2 group-hover:text-indigo-600 dark:group-hover:text-indigo-400",children:r})},r))})}}}]);