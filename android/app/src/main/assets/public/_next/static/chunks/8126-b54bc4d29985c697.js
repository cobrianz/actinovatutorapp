"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8126],{98126:(t,e,o)=>{o.r(e),o.d(e,{downloadCourseAsPDF:()=>c,downloadQuizAsPDF:()=>d,downloadReceiptAsPDF:()=>h});var i=o(18831);let l=[37,99,235],a=[31,41,55],r=[107,114,128],n=[229,231,235],s=async(t,e,i)=>{try{let l,{Filesystem:a,Directory:r}=await Promise.all([o.e(7805),o.e(8276)]).then(o.bind(o,78276)).catch(()=>({})),{Share:n}=await Promise.all([o.e(7805),o.e(8493)]).then(o.bind(o,98493)).catch(()=>({})),{LocalNotifications:s}=await Promise.all([o.e(7805),o.e(9968)]).then(o.bind(o,59968)).catch(()=>({}));if(!a||!n||!s)throw Error("Capacitor plugins not available");try{await s.requestPermissions()}catch(t){console.warn("Notification permissions denied",t)}try{try{await a.mkdir({path:"Download/Actinova",directory:r.ExternalStorage,recursive:!0})}catch(t){}l=await a.writeFile({path:`Download/Actinova/${t}`,data:e,directory:r.ExternalStorage})}catch(o){console.warn("ExternalStorage write failed, falling back to Documents",o);try{await a.mkdir({path:"Actinova",directory:r.Documents,recursive:!0})}catch(t){}l=await a.writeFile({path:`Actinova/${t}`,data:e,directory:r.Documents})}await s.schedule({notifications:[{title:t,body:"Download complete",id:Math.floor(1e5*Math.random()),schedule:{at:new Date(Date.now()+100)},sound:null,attachments:null,actionTypeId:"",extra:null}]}),await n.share({title:"Actinova Download",text:`Here is your file: ${i}`,url:l.uri,dialogTitle:"Open File"})}catch(l){console.error("Mobile save failed:",l),Promise.resolve().then(o.bind(o,66609)).then(({toast:t})=>{t.error("Download failed on mobile device. Trying browser fallback.")});let i=document.createElement("a");i.href=`data:application/pdf;base64,${e}`,i.download=t,i.click()}},c=async(t,e="course")=>{if(!t)throw Error("No data provided");let o=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),c=25,d=(t,e)=>{o.setDrawColor(...n),o.setLineWidth(.2),o.setFont("helvetica","normal"),o.setFontSize(8),o.setTextColor(...r),o.text("Actinova AI Tutor - Personalized Learning",20,287),o.text("Copyright \xa9 Actinova AI Tutor. All rights reserved.",105,287,{align:"center"}),o.text(`Page ${t} of ${e}`,190,287,{align:"right"})},h=t=>c+t>272&&(o.addPage(),c=25,!0);o.setFillColor(255,255,255),o.rect(0,0,210,297,"F"),c=40;try{o.addImage("/logo.png","PNG",85,c,40,40),c+=45}catch(t){c=80}c+=16,o.setTextColor(...a),o.setFont("helvetica","bold"),o.setFontSize(48),o.text("ACTINOVA",105,c,{align:"center"}),c+=12,o.setFontSize(24),o.text("AI TUTOR PLATFORM",105,c,{align:"center"}),c=150;let x=o.splitTextToSize(t.title||"Study Material",150);x.length,o.setTextColor(...l),o.setFontSize(14),o.text("NOTES"===e.toUpperCase()?"PERSONALIZED STUDY NOTES":"PERSONALIZED COURSE MATERIAL",105,c,{align:"center"}),c+=15,o.setTextColor(...a),o.setFontSize(28),o.text(x,105,c,{align:"center"}),c+=12*x.length+10,o.setFontSize(12),o.setTextColor(...r),o.text(`Generated on ${new Date().toLocaleDateString()}`,105,c,{align:"center"}),o.addPage(),c=30;let g=(t,e,i=11)=>{o.setFontSize(i),o.setFont("helvetica","normal"),o.setTextColor(...a);let l=t.replace(/\*\*\*([^*]+)\*\*\*/g,"$1").replace(/\*\*([^*]+)\*\*/g,"$1").replace(/\*([^*]+)\*/g,"$1").replace(/__([^_]+)__/g,"$1").replace(/_([^_]+)_/g,"$1").replace(/~~([^~]+)~~/g,"$1").replace(/`([^`]+)`/g,"$1").trim();o.splitTextToSize(l,170-(e-20)).forEach(t=>{h(8),o.text(t,e,c),c+=7})},p=(t,e=null)=>{if(!t)return;let i=t.split("\n"),s=!1,d=!0;i.forEach(t=>{let e=t.trim();if(e.startsWith("```")){s=!s,c+=2,d=!1;return}if(s){o.setFont("courier","normal"),o.setFontSize(10),o.setFillColor(245,245,245),o.rect(22,c-4,166,6,"F"),o.text(t,24,c),c+=6,o.setFont("helvetica","normal"),d=!1;return}if(["---","***","___"].includes(e)){h(10),c+=15,d=!1;return}if(!e){c+=5,d=!1;return}if(h(12),e.startsWith("# Module: ")||e.startsWith("MODULE: ")||e.startsWith("Module: ")){d=!1;return}if(e.startsWith("## LESSON: ")||e.startsWith("LESSON: ")||e.startsWith("Lesson: ")){c+=5,o.setFont("helvetica","bold"),o.setFontSize(20),o.setTextColor(...l);let t=e.replace(/^##\s*/,"").replace(/^LESSON:\s*/i,"");t=t.toUpperCase();let i=o.splitTextToSize(t,170);o.text(i,20,c),c+=10*i.length;let a=o.getTextWidth(i[i.length-1]);o.setDrawColor(...l),o.setLineWidth(.8),o.line(20,c-2,20+a,c-2),c+=5,d=!1;return}if(d&&!e.startsWith("#")&&!e.startsWith("##")&&!e.startsWith("###")&&!e.startsWith("> ")&&!e.match(/^[-*•]\s/)&&!e.match(/^\d+\.\s/)){c+=5,o.setFont("helvetica","bold"),o.setFontSize(26),o.setTextColor(...l);let t=o.splitTextToSize(e,160);o.text(t,20,c),c+=12*t.length+8,d=!1;return}if(d=!1,e.startsWith("# ")){let t=o.splitTextToSize(text,170);o.text(t,20,c),c+=12*t.length+8}else if(e.startsWith("## ")){c+=5,o.setFont("helvetica","bold"),o.setFontSize(20),o.setTextColor(...l);let t=e.substring(3).replace(/[\*_]/g,"").trim(),i=o.splitTextToSize(t,170);o.text(i,20,c),c+=10*i.length+5}else if(e.startsWith("### ")){c+=4,o.setFont("helvetica","bold"),o.setFontSize(16),o.setTextColor(...a);let t=e.substring(4).replace(/[\*_]/g,"").trim(),i=o.splitTextToSize(t,170);o.text(i,20,c),c+=9*i.length+4}else if(e.startsWith("#### ")){c+=3,o.setFont("helvetica","bold"),o.setFontSize(14),o.setTextColor(...a);let t=e.substring(5).replace(/[\*_]/g,"").trim(),i=o.splitTextToSize(t,170);o.text(i,20,c),c+=8*i.length+3}else if(e.startsWith("> ")){let t=e.substring(2).trim();o.setFont("helvetica","italic"),o.setTextColor(...r);let i=o.splitTextToSize(t,160);h(6*i.length+4),o.setDrawColor(...n),o.setLineWidth(1),o.line(22,c-4,22,c+6*i.length-4),o.text(i,28,c),c+=6*i.length+4,o.setFont("helvetica","normal")}else if(e.match(/^[-*•]\s/))o.setFont("helvetica","bold"),o.setTextColor(...l),o.text("•",22,c),g(e.replace(/^[-*•]\s/,""),28);else if(e.match(/^\d+\.\s/)){let t=e.match(/^\d+\./)[0];o.setFont("helvetica","bold"),o.setTextColor(...l),o.text(t,20,c),g(e.replace(/^\d+\.\s/,""),30)}else g(e,20)})};if("course"===e){let e=t.modules||t.courseData?.modules||[];o.setFont("helvetica","bold"),o.setFontSize(24),o.setTextColor(...l),o.text("Table of Contents",20,c),c+=15,e.forEach((t,e)=>{h(12),o.setFontSize(12),o.setFont("helvetica","normal"),o.setTextColor(...a),o.text(`Module ${e+1}: ${t.title}`,20,c),c+=8}),e.forEach((t,e)=>{o.addPage(),c=35,t.lessons?.forEach((t,i)=>{h(20),o.setFont("helvetica","bold"),o.setFontSize(16),o.setTextColor(...a),o.text(`${e+1}.${i+1} ${t.title||t}`,20,c),c+=12,t.content&&p(t.content,t.title||t),c+=10})})}else p(t.content,t.title);let T=o.internal.pages.length-1;for(let t=1;t<=T;t++)o.setPage(t),d(t,T);let u=`${t.title?.replace(/\s+/g,"_").toLowerCase()||"actinova_study"}.pdf`;if(window.Capacitor||"capacitor:"===window.location.protocol){let e=o.output("datauristring").split(",")[1];await s(u,e,t.title)}else o.save(u)},d=async t=>{if(!t||!t.questions)throw Error("No data provided");let e=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=40,c=(o,i)=>{e.setDrawColor(...n),e.setLineWidth(.2),e.setFontSize(8),e.setTextColor(...r),e.text(`Actinova AI Tutor - Assessment: ${t.title}`,20,12),o&&e.text(`Page ${o} of ${i}`,190,12,{align:"right"})};c(),e.setFont("helvetica","bold"),e.setFontSize(24),e.setTextColor(...l),e.text("ASSESSMENT PAPER",105,o,{align:"center"}),o+=12,e.setFontSize(14),e.setTextColor(...r),e.text(`Subject: ${t.topic||"General Knowledge"}`,105,o,{align:"center"}),o+=20,e.setDrawColor(...l),e.setLineWidth(1),o+=15,t.questions.forEach((t,i)=>{let l=e.splitTextToSize(`${i+1}. ${t.text}`,160),n=8*(t.options?.length||0);o+6*l.length+n+20>267&&(e.addPage(),c(),o=25),e.setFont("helvetica","bold"),e.setFontSize(12),e.setTextColor(...a),e.text(l,20,o),o+=6*l.length+5,t.options?(e.setFont("helvetica","normal"),e.setFontSize(11),t.options.forEach((t,i)=>{e.setTextColor(...r),e.text(String.fromCharCode(65+i)+")",25,o),e.setTextColor(...a),e.text(e.splitTextToSize(t,150),35,o),o+=8})):o+=15,o+=10}),e.addPage(),c(),o=30,e.setFont("helvetica","bold"),e.setFontSize(18),e.setTextColor(...l),e.text("ANSWER KEY",20,o),o+=15,e.setFontSize(11),t.questions.forEach((t,i)=>{o>277&&(e.addPage(),c(),o=25),e.setFont("helvetica","bold"),e.setTextColor(...a),e.text(`${i+1}: `,20,o),e.setFont("helvetica","normal"),e.setTextColor(...l),e.text(String(t.correctAnswer),30,o),o+=8});let d=e.internal.pages.length-1;for(let t=1;t<=d;t++)e.setPage(t),c(t,d);let h=`assessment_${t.title?.replace(/\s+/g,"_").toLowerCase()||"exam"}.pdf`;if(window.Capacitor||"capacitor:"===window.location.protocol){let o=e.output("datauristring").split(",")[1];await s(h,o,t.title)}else e.save(h)},h=async t=>{if(!t)throw Error("No data provided");let e=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=40;e.setFillColor(248,250,252),e.rect(0,0,210,50,"F"),e.setFont("helvetica","bold"),e.setFontSize(24),e.setTextColor(...l),e.text("RECEIPT",190,25,{align:"right"}),e.setFontSize(10),e.setTextColor(...r),e.text("PAYMENT CONFIRMATION",190,32,{align:"right"}),e.setFontSize(18),e.setTextColor(...a),e.text("Actinova AI Tutor",20,25),e.setFontSize(10),e.setTextColor(...r),e.text("123 Learning Lane, EdTech City",20,32),o=70,e.setDrawColor(...n),e.setLineWidth(.5),o+=15;let c=(t,i,l=!1)=>{e.setFont("helvetica","normal"),e.setFontSize(10),e.setTextColor(...r),e.text(t,20,o),e.setFont("helvetica",l?"bold":"normal"),e.setTextColor(...a),e.text(i,190,o,{align:"right"}),o+=10};c("Reference ID",t.reference||"N/A"),c("Date",new Date(t.date||t.paidAt||Date.now()).toLocaleDateString()),c("Plan",t.plan||"Premium Subscription"),c("Billing Cycle",t.billingCycle||"Monthly"),o+=5,e.line(20,o,190,o),o+=15,e.setFont("helvetica","bold"),e.setFontSize(14),e.setTextColor(...a),e.text("Total Amount",20,o),e.setFontSize(18),e.setTextColor(...l),e.text(new Intl.NumberFormat("en-US",{style:"currency",currency:t.currency||"USD"}).format(t.amount||0),190,o,{align:"right"}),o+=40,e.setFont("helvetica","normal"),e.setFontSize(9),e.setTextColor(...r),e.text("Thank you for your business!",105,o,{align:"center"});let d=`receipt-${t.reference||"transaction"}.pdf`;if(window.Capacitor||"capacitor:"===window.location.protocol){let o=e.output("datauristring").split(",")[1];await s(d,o,`Receipt ${t.reference}`)}else e.save(d)}}}]);