"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[913],{30913:(e,t,o)=>{o.d(t,{O5:()=>p,n$:()=>C,Iu:()=>f,D6:()=>T});var i=o(18831),l=o(28776);let r=[30,64,175],n=[238,244,255],s=[17,24,39],a=[75,85,99],c=[229,231,235],d=[34,197,94],h=async(e,t,i,l,r="File")=>{if(window.Capacitor||"capacitor:"===window.location.protocol)try{let n=e.output("datauristring").split(",")[1],{Filesystem:s,Directory:a}=await Promise.all([o.e(7805),o.e(8276)]).then(o.bind(o,78276)).catch(()=>({})),{Share:c}=await Promise.all([o.e(7805),o.e(8493)]).then(o.bind(o,98493)).catch(()=>({})),{LocalNotifications:d}=await Promise.all([o.e(7805),o.e(9968)]).then(o.bind(o,59968)).catch(()=>({})),h=await s.writeFile({path:t,data:n,directory:a.Downloads,recursive:!0});if(d)try{let e=await d.checkPermissions();"granted"!==e.display&&await d.requestPermissions(),await d.schedule({notifications:[{title:"Download Complete",body:l||`Your ${r.toLowerCase()} "${i}" is ready.`,id:Math.floor(1e6*Math.random()),schedule:{at:new Date(Date.now()+500)},iconColor:"#1E40AF",actionTypeId:"OPEN_FILE"}]})}catch(e){console.error("[PDF] Notification error:",e)}if(c)try{await c.share({title:`${r} Ready`,text:`Your ${i} has been downloaded.`,url:h.uri,dialogTitle:"Open/Share Document"})}catch(e){console.error("[PDF] Share error:",e)}}catch(o){console.error("Capacitor PDF error:",o),e.save(t)}else e.save(t)},x=(e,t,o)=>{e.setFillColor(...r),e.rect(0,0,210,10,"F"),e.setDrawColor(...c),e.setLineWidth(.3),e.line(25,277,185,277),e.setFont("helvetica","normal"),e.setFontSize(9),e.setTextColor(...a),e.text("Actinova AI Tutor • Your Intelligent Learning Companion",25,285),e.text(`Page ${t} of ${o}`,185,285,{align:"right"})},g=(e,t,o)=>o+t>267?(e.addPage(),30):o,m=(e,t,o,i,l,r=11,n)=>{e.setFontSize(r),e.setTextColor(...s);let a=t.trim().replace(/^[#\s]+/,"").replace(/\\\[(.*?)\\\]/g,"$1").replace(/\$\$(.*?)\$\$/g,"$1").replace(/\\\( (.*?) \\\)/g,"$1");return e.splitTextToSize(a,l-(o-25)).forEach(t=>{let l=.3527*r*1.8;i=n(e,l+2,i);let s=t.split(RegExp("(\\*\\*.*?\\*\\*|__.*?__|(?<!\\*)\\*.*?\\*(?!\\*)|(?<!_)_.*?_(?!_)|~~.*?~~)","g")),a=o;s.forEach(t=>{let o=t.startsWith("**")&&t.endsWith("**")||t.startsWith("__")&&t.endsWith("__"),l=t.startsWith("*")&&t.endsWith("*")||t.startsWith("_")&&t.endsWith("_"),n=t.startsWith("~~")&&t.endsWith("~~");if(o){e.setFont("helvetica","bold");let o=t.slice(2,-2);o&&(e.text(o,a,i),a+=e.getTextWidth(o))}else if(l){e.setFont("helvetica","italic");let o=t.slice(1,-1);o&&(e.text(o,a,i),a+=e.getTextWidth(o))}else if(n){let o=t.slice(2,-2);if(o){e.setFont("helvetica","normal"),e.text(o,a,i);let t=e.getTextWidth(o);e.setLineWidth(.2),e.line(a,i-.12*r,a+t,i-.12*r),a+=t}}else t&&(e.setFont("helvetica","normal"),e.text(t,a,i),a+=e.getTextWidth(t))}),i+=l}),i},F=async(e,t,o,i={})=>{let{margin:l=25,contentWidth:a=160,titleToSkip:c=null,isFirstLesson:d=!0}=i;if(!t)return o;let h=t.split("\n"),x=o,F=!1,p=[],C=[],f=()=>{if(p.length<2){p=[];return}x=g(e,30,x);let t=p.map(e=>e.split("|").map(e=>e.trim()).filter(e=>e)),o=t[0],i=(a-10)/o.length;e.setFillColor(...n),e.rect(l,x,a,12,"F"),e.setFont("helvetica","bold"),e.setFontSize(11),e.setTextColor(...r),o.forEach((t,o)=>e.text(t,l+5+o*i,x+8)),x+=12,e.setFont("helvetica","normal"),e.setFontSize(10),e.setTextColor(...s),t.slice(1).forEach((t,o)=>{x=g(e,10,x),o%2==0&&(e.setFillColor(248,250,255),e.rect(l,x,a,10,"F")),t.forEach((t,o)=>{let r=e.splitTextToSize(t,i-8);e.text(r,l+5+o*i,x+6)}),x+=10}),x+=8,p=[]};for(let t of h){let o=t.trim();if(!o&&!F){x+=8;continue}if(!o.toLowerCase().includes("mermaid diagram for")){if(o.startsWith("```")){if(f(),"mermaid"===o.substring(3).trim())F="mermaid",C=[];else if("mermaid"===F){F=!1;let t=C.join("\n");if(t.trim()){let o=await u(t);if(o){let t=o.height/o.width,i=Math.min(.9*a,o.width),l=i*t;x=g(e,l+20,x),e.addImage(o.dataUrl,"PNG",(210-i)/2,x,i,l),x+=l+15}}}else F=!F;continue}if("mermaid"===F){C.push(t);continue}if(F){x=g(e,8,x),e.setFont("courier","normal"),e.setFontSize(9),e.setFillColor(249,250,251),e.rect(l+2,x-5,a-4,8,"F"),e.text(t,l+6,x),x+=8;continue}if(o.startsWith("|")&&o.endsWith("|")){p.push(o);continue}if(f(),x=g(e,14,x),o.startsWith("# ")){let t=o.substring(2).replace(/[\*_]/g,"").trim();if(c&&t.toLowerCase()===c.toLowerCase()||c&&d)continue;x+=10,e.setFillColor(...n),e.rect(l-5,x-10,a+10,28,"F"),e.setFont("helvetica","bold"),e.setFontSize(28),e.setTextColor(...r),e.text(t,l,x+10),x+=35}else if(o.startsWith("## ")){let t=o.substring(3).replace(/[\*_]/g,"").trim();if(c&&t.toLowerCase()===c.toLowerCase())continue;x+=16,e.setFont("helvetica","bold"),e.setFontSize(22),e.setTextColor(...r),e.text(t,l,x),x+=12}else if(o.startsWith("### "))x+=10,e.setFont("helvetica","bold"),e.setFontSize(16),e.setTextColor(...s),e.text(o.substring(4).trim(),l,x),x+=10;else if(o.match(/^[-*•]\s/))e.setFontSize(14),e.setTextColor(...r),e.text("●",l+4,x),x=m(e,o.replace(/^[-*•]\s/,""),l+14,x,a,11,g);else if(o.match(/^\d+\.\s/)){let t=o.match(/^\d+\./)[0];e.setFont("helvetica","bold"),e.setTextColor(...r),e.text(t,l,x),x=m(e,o.replace(/^\d+\.\s/,""),l+12,x,a,11,g)}else x=m(e,o,l,x,a,11,g)}}return f(),x},u=async e=>{try{let t=e.replace(/\[([\s\S]*?)\]/g,(e,t)=>t.includes('"')?`["${t.trim().replace(/"/g,'""')}"]`:e),o=`mermaid-${Date.now()}`;l.A.initialize({startOnLoad:!1,theme:"neutral"});let{svg:i}=await l.A.render(o,t);return new Promise(e=>{let t=new Image,o=btoa(unescape(encodeURIComponent(i)));t.src=`data:image/svg+xml;base64,${o}`,t.onload=()=>{let o=document.createElement("canvas");o.width=3*t.width,o.height=3*t.height;let i=o.getContext("2d");i.fillStyle="#ffffff",i.fillRect(0,0,o.width,o.height),i.scale(3,3),i.drawImage(t,0,0),e({dataUrl:o.toDataURL("image/png"),width:t.width,height:t.height})},t.onerror=()=>e(null)})}catch(e){return console.error("Mermaid error:",e),null}},p=async e=>{if(!e)throw Error("No data provided");let t=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=30;t.setFillColor(...n),t.rect(0,0,210,297,"F");try{t.addImage("/logo.png","PNG",80,o,50,50),o+=70}catch(e){o+=30}t.setFont("helvetica","bold"),t.setFontSize(40),t.setTextColor(...r),t.text("ACTINOVA",105,o,{align:"center"}),o+=15,t.setFontSize(18),t.setTextColor(...a),t.text("AI Tutor Platform",105,o,{align:"center"}),o=140,t.setFillColor(255,255,255),t.setDrawColor(...r),t.setLineWidth(2),t.roundedRect(25,o,160,80,10,10,"FD"),t.setTextColor(...r),t.setFontSize(32);let l=t.splitTextToSize(e.title||"Full Course Material",120);t.text(l,105,o+30,{align:"center"}),t.setFontSize(14),t.setTextColor(...a),t.text("Personalized Course Textbook",105,o+60,{align:"center"}),t.text(`Generated: ${new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}`,105,o+75,{align:"center"}),t.addPage(),o=40;let c=e.modules||e.courseData?.modules||[];t.setFont("helvetica","bold"),t.setFontSize(28),t.setTextColor(...r),t.text("Table of Contents",25,o),o+=20,c.forEach((e,i)=>{o=g(t,20,o),t.setFontSize(16),t.setTextColor(...s),t.text(`Module ${i+1}: ${e.title}`,25,o),o+=12,e.lessons&&e.lessons.forEach((e,l)=>{o=g(t,10,o),t.setFontSize(12),t.setTextColor(...a),t.text(`  ${i+1}.${l+1}  ${e.title||"Untitled Lesson"}`,30,o),o+=8}),o+=8});for(let e=0;e<c.length;e++){let i=c[e];t.addPage(),o=40,t.setFont("helvetica","bold"),t.setFontSize(34),t.setTextColor(...r),t.text(`MODULE ${e+1}`,25,o),o+=18,t.setFontSize(24),t.setTextColor(...s);let l=t.splitTextToSize(i.title.toUpperCase(),160);if(t.text(l,25,o),o+=12*l.length+20,i.lessons)for(let l=0;l<i.lessons.length;l++){let n=i.lessons[l];o=g(t,50,o),t.setFont("helvetica","bold"),t.setFontSize(20),t.setTextColor(...r);let s=`${e+1}.${l+1} ${n.title||"Lesson"}`,a=t.splitTextToSize(s,160);t.text(a,25,o),o+=10*a.length+15,n.content&&(o=await F(t,n.content,o,{titleToSkip:n.title,isFirstLesson:!0})),o+=20}}let d=t.getNumberOfPages();for(let e=1;e<=d;e++)t.setPage(e),x(t,e,d);let m=`${(e.title||"course").replace(/\s+/g,"_").toLowerCase()}.pdf`;await h(t,m,e.title,`Your full course textbook "${e.title}" is ready.`,"Course")},C=async e=>{if(!e||!e.content)throw Error("No content provided");let t=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=25;t.setFillColor(255,255,255),t.rect(0,0,210,297,"F"),o=40;try{t.addImage("/logo.png","PNG",85,o,40,40),o+=45}catch(e){o=80}o+=16,t.setTextColor(...s),t.setFont("helvetica","bold"),t.setFontSize(40),t.text("STUDY NOTES",105,o,{align:"center"}),o=150;let l=t.splitTextToSize(e.title||"Lesson Material",120),n=40+12*l.length+20;t.setDrawColor(...r),t.setLineWidth(.5),t.roundedRect(25,o-15,160,n,2,2,"D"),t.setTextColor(...r),t.setFontSize(14),t.text("PERSONALIZED ACADEMIC CONTENT",105,o,{align:"center"}),o+=15,t.setTextColor(...s),t.setFontSize(28),t.text(l,105,o,{align:"center",maxWidth:120}),o+=12*l.length+10,t.setFontSize(12),t.setTextColor(...a),t.text(`Generated on ${new Date().toLocaleDateString()}`,105,o,{align:"center"}),t.addPage(),o=30,t.setFont("helvetica","bold"),t.setFontSize(22),t.setTextColor(...r);let c=t.splitTextToSize(e.title||"Lesson Material",160);t.text(c,25,o),o+=8*c.length+6,o=await F(t,e.content,o,{titleToSkip:e.title,isFirstLesson:!0});let d=t.internal.pages.length-1;for(let e=1;e<=d;e++)t.setPage(e),x(t,e,d);let g=`${e.title?.replace(/\s+/g,"_").toLowerCase()||"lesson"}.pdf`;await h(t,g,e.title,"Your lesson notes are ready.","Lesson")},f=async e=>{if(!e||!e.questions)throw Error("No data provided");let t=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=40,l=(o,i)=>{t.setDrawColor(...c),t.setLineWidth(.1),t.line(25,15,185,15),t.setFontSize(8),t.setTextColor(...a),t.text(`Actinova AI Tutor - Assessment: ${e.title}`,25,12),o&&t.text(`Page ${o} of ${i}`,185,12,{align:"right"})};l(),t.setFont("helvetica","bold"),t.setFontSize(24),t.setTextColor(...r),t.text("ASSESSMENT PAPER",105,o,{align:"center"}),o+=12,t.setFontSize(14),t.setTextColor(...a),t.text(`Subject: ${e.topic||"General Knowledge"}`,105,o,{align:"center"}),o+=20,e.questions.forEach((e,i)=>{let l=t.splitTextToSize(`${i+1}. ${e.text}`,150),r=8*(e.options?.length||0);o=g(t,6*l.length+r+20,o),t.setFont("helvetica","bold"),t.setFontSize(12),t.setTextColor(...s),t.text(l,25,o),o+=6*l.length+4,e.options&&(t.setFont("helvetica","normal"),t.setFontSize(11),e.options.forEach((e,i)=>{t.setTextColor(...a),t.text(String.fromCharCode(65+i)+")",30,o),t.setTextColor(...s),t.text(t.splitTextToSize(e,140),40,o),o+=8})),o+=6}),t.addPage(),l(),o=30,t.setFont("helvetica","bold"),t.setFontSize(18),t.setTextColor(...r),t.text("ANSWER KEY",25,o),o+=15,t.setFontSize(11),e.questions.forEach((e,i)=>{o=g(t,10,o),t.setFont("helvetica","bold"),t.setTextColor(...s),t.text(`${i+1}: `,25,o),t.setFont("helvetica","normal"),t.setTextColor(...r),t.text(String(e.correctAnswer),35,o),o+=10});let n=t.internal.pages.length-1;for(let e=1;e<=n;e++)t.setPage(e),l(e,n);let d=`assessment_${e.title?.replace(/\s+/g,"_").toLowerCase()||"exam"}.pdf`;await h(t,d,e.title,"Assessment downloaded successfully.","Assessment")},T=async(e,t="Scholar")=>{if(!e)throw Error("No data provided");let o=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),l=30;o.setFontSize(70),o.setTextColor(240,240,240),o.text("ACTINOVA",105,160,{align:"center"});try{o.addImage("/logo.png","PNG",85,l,40,40),l+=55}catch(e){l+=10}o.setFillColor(...r),o.rect(25,l,160,15,"F"),o.setFont("helvetica","bold"),o.setFontSize(18),o.setTextColor(255,255,255),o.text("PAYMENT RECEIPT",105,l+10,{align:"center"}),l+=30,o.setTextColor(...s),o.setFontSize(22),o.text("Actinova AI Tutor",105,l,{align:"center"}),l+=12,o.setFontSize(12),o.setTextColor(...a),o.text("Your Intelligent Learning Companion",105,l,{align:"center"}),l+=20,o.setFontSize(12),o.setTextColor(...s),o.text(`Billed to: ${t}`,105,l,{align:"center"}),l+=20,o.setFont("helvetica","bold"),o.setFontSize(16),o.text("Thank you for your subscription!",105,l,{align:"center"}),l+=25;let n=new Date(e.date||e.paidAt||Date.now()).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});o.setFontSize(11),o.setFont("helvetica","bold"),o.text("Date:",35,l),o.text(n,75,l),o.text("Plan:",115,l),o.text(e.plan||"Pro",145,l),l+=10,o.text("Receipt #:",35,l),o.text(e.reference?.toUpperCase()||"N/A",75,l),o.text("Status:",115,l),o.setTextColor(...d),o.text("PAID",145,l),l+=20,o.setFontSize(20),o.setTextColor(...r);let c=new Intl.NumberFormat("en-US",{style:"currency",currency:e.currency||"USD"}).format(e.amount||0);o.text(`Amount: ${c}`,105,l,{align:"center"}),l+=30,o.setFontSize(10),o.setTextColor(...a),o.text("This is an official receipt. Contact support@actinova.ai for questions.",105,l,{align:"center"});let x=`receipt-${e.reference||"payment"}.pdf`;await h(o,x,"Subscription Payment","Your receipt has been downloaded.","Receipt")}}}]);