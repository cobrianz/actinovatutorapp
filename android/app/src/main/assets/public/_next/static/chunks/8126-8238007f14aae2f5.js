"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8126],{98126:(t,e,o)=>{o.d(e,{D6:()=>g,Iu:()=>x,O5:()=>d});var i=o(18831),l=o(28776);let a=[37,99,235],r=[239,246,255],n=[31,41,55],s=[107,114,128],c=[229,231,235],h=async(t,e,i,l,a="File")=>{if(window.Capacitor||"capacitor:"===window.location.protocol)try{let r=t.output("datauristring").split(",")[1],{Filesystem:n,Directory:s}=await Promise.all([o.e(7805),o.e(8276)]).then(o.bind(o,78276)).catch(()=>({})),{Share:c}=await Promise.all([o.e(7805),o.e(8493)]).then(o.bind(o,98493)).catch(()=>({})),{LocalNotifications:h}=await Promise.all([o.e(7805),o.e(9968)]).then(o.bind(o,59968)).catch(()=>({}));if(!n||!c||!h)throw Error("Capacitor plugins not available");try{await h.requestPermissions()}catch(t){console.warn("Notification permissions denied",t)}let d=await n.writeFile({path:e,data:r,directory:s.Documents});await h.schedule({notifications:[{title:"Download Complete",body:l,id:Math.floor(1e5*Math.random()),schedule:{at:new Date(Date.now()+100)},sound:null,attachments:null,actionTypeId:"",extra:null}]}),await c.share({title:`Actinova ${a} Download`,text:`${a} for ${i}`,url:d.uri,dialogTitle:"Save or Open PDF"})}catch(o){console.error("Capacitor PDF error:",o),t.save(e)}else t.save(e)},d=async(t,e="course")=>{if(!t)throw Error("No data provided");let o=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),d=25,x=async t=>{try{let e=t.replace(/\[([\s\S]*?)\]/g,(t,e)=>/[()",]/.test(e)?`["${e.trim().replace(/"/g,'""')}"]`:t),o=`mermaid-pdf-${Date.now()}-${Math.floor(1e4*Math.random())}`;l.A.initialize({startOnLoad:!1,theme:"default"});let{svg:i}=await l.A.render(o,e);return new Promise(t=>{let e=new Image,o=btoa(unescape(encodeURIComponent(i))),l=`data:image/svg+xml;base64,${o}`;e.onload=()=>{let o=document.createElement("canvas");o.width=3*e.width,o.height=3*e.height;let i=o.getContext("2d");i.fillStyle="#ffffff",i.fillRect(0,0,o.width,o.height),i.scale(3,3),i.drawImage(e,0,0),t({dataUrl:o.toDataURL("image/png"),width:e.width,height:e.height})},e.onerror=()=>t(null),e.crossOrigin="anonymous",e.src=l})}catch(t){return console.error("Mermaid render error:",t),null}},g=(t,e)=>{o.setDrawColor(...c),o.setLineWidth(.2),o.line(20,15,190,15),o.line(20,282,190,282),o.setFont("helvetica","normal"),o.setFontSize(8),o.setTextColor(...s),o.text("Actinova AI Tutor - Premium Study Material",20,287),o.text(`Page ${t} of ${e}`,190,287,{align:"right"})},m=t=>d+t>272&&(o.addPage(),d=25,!0),u=(t,e,i=11,l=!1)=>{o.setFontSize(i),o.setTextColor(...n),o.splitTextToSize(t.trim(),170-(e-20)).forEach(t=>{let l=.3527*i*1.8;m(l+2);let a=t.split(/(\*\*.*?\*\*)/g),r=e;a.forEach(t=>{if(t.startsWith("**")&&t.endsWith("**")){o.setFont("helvetica","bold");let e=t.slice(2,-2);o.text(e,r,d),r+=o.getTextWidth(e)}else o.setFont("helvetica","normal"),o.text(t,r,d),r+=o.getTextWidth(t)}),d+=l})};o.setFillColor(255,255,255),o.rect(0,0,210,297,"F"),d=40;try{o.addImage("/logo.png","PNG",85,d,40,40),d+=45}catch(t){d=80}d+=16,o.setTextColor(...n),o.setFont("helvetica","bold"),o.setFontSize(48),o.text("ACTINOVA",105,d,{align:"center"}),d+=12,o.setFontSize(24),o.text("AI TUTOR PLATFORM",105,d,{align:"center"}),d=150;let f=o.splitTextToSize(t.title||"Study Material",150),p=40+12*f.length+20;o.setDrawColor(...a),o.setLineWidth(.5),o.roundedRect(15,d-15,180,p,2,2,"D"),o.setTextColor(...a),o.setFontSize(14),o.text("NOTES"===e.toUpperCase()?"PERSONALIZED STUDY NOTES":"PERSONALIZED COURSE MATERIAL",105,d,{align:"center"}),d+=15,o.setTextColor(...n),o.setFontSize(28),o.text(f,105,d,{align:"center"}),d+=12*f.length+10,o.setFontSize(12),o.setTextColor(...s),o.text(`Generated on ${new Date().toLocaleDateString()}`,105,d,{align:"center"});let F="",C=async(t,e=null)=>{if(!t)return;let i=t.split("\n"),l=!1,c=[],h=[],g=()=>{if(0===c.length)return;m(25),d+=5;let t=c.map(t=>t.split("|").map(t=>t.trim()).filter(t=>""!==t));if(t.length<2)return;let e=t[0],i=160/e.length;o.setFillColor(245,247,250),o.rect(20,d,170,10,"F"),o.setFont("helvetica","bold"),o.setFontSize(10),o.setTextColor(...n),e.forEach((t,e)=>o.text(t,25+e*i,d+6)),d+=10,o.setFont("helvetica","normal"),t.slice(2).forEach((t,e)=>{m(10),e%2==1&&(o.setFillColor(249,250,251),o.rect(20,d,170,10,"F")),t.forEach((t,e)=>{let l=o.splitTextToSize(t,i-5);o.text(l,25+e*i,d+6)}),o.setDrawColor(230,230,230),o.line(20,d+10,190,d+10),d+=10}),d+=5,c=[]};for(let t of i){let i=t.trim();if(!i&&!l){d+=8;continue}if(i.startsWith("```")){if(g(),"mermaid"===i.substring(3).trim())l="mermaid",h=[];else if("mermaid"===l){l=!1;let t=h.join("\n");if(t.trim()){let e=await x(t);if(e){let t=e.height/e.width,i=Math.min(170,.2*e.width),l=i*t;m(l+15),o.addImage(e.dataUrl,"PNG",(210-i)/2,d,i,l),d+=l+10}}}else l=!l;continue}if("mermaid"===l){h.push(t);continue}if(l){o.setFont("courier","normal"),o.setFontSize(10),o.setFillColor(248,250,252),o.rect(22,d-4,166,6,"F"),o.text(t,24,d),d+=6;continue}if(i.startsWith("|")&&i.endsWith("|")){c.push(i);continue}if(g(),m(12),(i.startsWith("# ")||i.startsWith("## "))&&(F=i.replace(/^#+\s*/,"").replace(/[\*_]/g,"").trim()),i.startsWith("# ")){let t=i.substring(2).replace(/[\*_]/g,"").trim();if(e&&t.toLowerCase().includes(e.toLowerCase()))continue;d+=15,o.setFont("helvetica","bold"),o.setFontSize(26),o.setTextColor(...a),o.text(t,20,d),d+=12,o.setDrawColor(...a),o.setLineWidth(.8),o.line(20,d-8,20+o.getTextWidth(t),d-8),d+=6}else if(i.startsWith("## ")){d+=15,o.setFont("helvetica","bold"),o.setFontSize(20),o.setTextColor(...a);let t=i.substring(3).replace(/[\*_]/g,"").trim();o.text(t,20,d),d+=10,o.setDrawColor(...r),o.setLineWidth(.4),o.line(20,d-7,190,d-7),d+=4}else if(i.startsWith("### ")){d+=7.5,o.setFont("helvetica","bold"),o.setFontSize(16),o.setTextColor(...n);let t=i.substring(4).replace(/[\*_]/g,"").trim();o.text(t,20,d),d+=9}else if(i.startsWith("> ")){let t=i.substring(2).trim();o.setFont("helvetica","italic"),o.setTextColor(...s);let e=o.splitTextToSize(t,155);m(8*e.length+5),o.setDrawColor(...a),o.setLineWidth(1.5),o.line(22,d-4,22,d+8*e.length-4),e.forEach(t=>{o.text(t,28,d),d+=8}),d+=5}else if(i.match(/^[-*•]\s/))F.toLowerCase().includes("practice exercises")?(o.setFont("helvetica","bold"),o.setTextColor(0,0,0),o.text("✓",22,d),u(i.replace(/^[-*•]\s/,""),30,11)):(o.setFont("helvetica","bold"),o.setTextColor(...a),o.text("•",22,d),u(i.replace(/^[-*•]\s/,""),28,11));else if(i.match(/^\d+\.\s/)){let t=i.match(/^\d+\./)[0];o.setFont("helvetica","bold"),o.setTextColor(...a),o.text(t,20,d),u(i.replace(/^\d+\.\s/,""),30,11)}else t.startsWith("    ")||t.startsWith("	")?u(i,30,11):u(i,20,11)}g()};if("course"===e){let e=t.modules||t.courseData?.modules||[];o.setFont("helvetica","bold"),o.setFontSize(24),o.setTextColor(...a),o.text("Table of Contents",20,d),d+=15,e.forEach((t,e)=>{m(12),o.setFontSize(12),o.setFont("helvetica","normal"),o.setTextColor(...n),o.text(`Module ${e+1}: ${t.title}`,20,d),d+=10});for(let t=0;t<e.length;t++){let i=e[t];if(o.addPage(),d=30,o.setFont("helvetica","bold"),o.setFontSize(32),o.setTextColor(...a),o.text(`MODULE ${t+1}`,20,d),d+=12,o.setFontSize(20),o.setTextColor(...n),o.text(i.title.toUpperCase(),20,d),d+=20,i.lessons)for(let t=0;t<i.lessons.length;t++){let e=i.lessons[t];m(30),d+=10,e.content&&await C(e.content,e.title||e)}}}else await C(t.content,t.title);let T=o.internal.pages.length-1;for(let t=1;t<=T;t++)o.setPage(t),g(t,T);let S=`${t.title?.replace(/\s+/g,"_").toLowerCase()||"actinova_study"}.pdf`;await h(o,S,t.title,`${t.title} saved to Documents. Tap to view.`,"Study Material")},x=async t=>{if(!t||!t.questions)throw Error("No data provided");let e=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=40,l=(o,i)=>{e.setDrawColor(...c),e.setLineWidth(.2),e.line(20,15,190,15),e.setFontSize(8),e.setTextColor(...s),e.text(`Actinova AI Tutor - Assessment: ${t.title}`,20,12),o&&e.text(`Page ${o} of ${i}`,190,12,{align:"right"})};l(),e.setFont("helvetica","bold"),e.setFontSize(24),e.setTextColor(...a),e.text("ASSESSMENT PAPER",105,o,{align:"center"}),o+=12,e.setFontSize(14),e.setTextColor(...s),e.text(`Subject: ${t.topic||"General Knowledge"}`,105,o,{align:"center"}),o+=20,t.questions.forEach((t,i)=>{let a=e.splitTextToSize(`${i+1}. ${t.text}`,160),r=8*(t.options?.length||0);o+6*a.length+r+20>267&&(e.addPage(),l(),o=25),e.setFont("helvetica","bold"),e.setFontSize(12),e.setTextColor(...n),e.text(a,20,o),o+=6*a.length+2,t.options?(e.setFont("helvetica","normal"),e.setFontSize(11),t.options.forEach((t,i)=>{e.setTextColor(...s),e.text(String.fromCharCode(65+i)+")",25,o),e.setTextColor(...n),e.text(e.splitTextToSize(t,150),35,o),o+=6})):o+=10,o+=5}),e.addPage(),l(),o=30,e.setFont("helvetica","bold"),e.setFontSize(18),e.setTextColor(...a),e.text("ANSWER KEY",20,o),o+=15,e.setFontSize(11),t.questions.forEach((t,i)=>{o>277&&(e.addPage(),l(),o=25),e.setFont("helvetica","bold"),e.setTextColor(...n),e.text(`${i+1}: `,20,o),e.setFont("helvetica","normal"),e.setTextColor(...a),e.text(String(t.correctAnswer),30,o),o+=6});let r=e.internal.pages.length-1;for(let t=1;t<=r;t++)e.setPage(t),l(t,r);let d=`assessment_${t.title?.replace(/\s+/g,"_").toLowerCase()||"exam"}.pdf`;await h(e,d,t.title,`Assessment for ${t.title} saved to Documents.`,"Assessment")},g=async t=>{if(!t)throw Error("No data provided");let e=new i.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=40;e.setFillColor(248,250,252),e.rect(0,0,210,50,"F"),e.setFont("helvetica","bold"),e.setFontSize(24),e.setTextColor(...a),e.text("RECEIPT",190,25,{align:"right"}),e.setFontSize(10),e.setTextColor(...s),e.text("PAYMENT CONFIRMATION",190,32,{align:"right"}),e.setFontSize(18),e.setTextColor(...n),e.text("Actinova AI Tutor",20,25),e.setFontSize(10),e.setTextColor(...s),e.text("123 Learning Lane, EdTech City",20,32),o=80;let l=(t,i,l=!1)=>{e.setFont("helvetica","normal"),e.setFontSize(10),e.setTextColor(...s),e.text(t,20,o),e.setFont("helvetica",l?"bold":"normal"),e.setTextColor(...n),e.text(i,190,o,{align:"right"}),o+=8};l("Reference ID",t.reference||"N/A"),l("Date",new Date(t.date||t.paidAt||Date.now()).toLocaleDateString()),l("Plan",t.plan||"Premium Subscription"),l("Billing Cycle",t.billingCycle||"Monthly"),o+=12,e.setFont("helvetica","bold"),e.setFontSize(14),e.setTextColor(...n),e.text("Total Amount",20,o),e.setFontSize(18),e.setTextColor(...a),e.text(new Intl.NumberFormat("en-US",{style:"currency",currency:t.currency||"USD"}).format(t.amount||0),190,o,{align:"right"}),o+=40,e.setFont("helvetica","normal"),e.setFontSize(9),e.setTextColor(...s),e.text("Thank you for your business!",105,o,{align:"center"});let r=`receipt-${t.reference||"transaction"}.pdf`;await h(e,r,t.plan||"Subscription",`Receipt for ${t.plan||"Subscription"} saved to Documents.`,"Receipt")}}}]);