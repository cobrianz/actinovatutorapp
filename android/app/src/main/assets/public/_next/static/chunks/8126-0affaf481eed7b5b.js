"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8126],{98126:(t,e,o)=>{o.d(e,{Iu:()=>h,O5:()=>c});var l=o(18831);let i=[37,99,235],s=[31,41,55],r=[107,114,128],a=[229,231,235],n=async(t,e,l,i,s="File")=>{if(window.Capacitor||"capacitor:"===window.location.protocol)try{let r=t.output("datauristring").split(",")[1],{Filesystem:a,Directory:n}=await Promise.all([o.e(7805),o.e(8276)]).then(o.bind(o,78276)).catch(()=>({})),{Share:c}=await Promise.all([o.e(7805),o.e(8493)]).then(o.bind(o,98493)).catch(()=>({})),{LocalNotifications:h}=await Promise.all([o.e(7805),o.e(9968)]).then(o.bind(o,59968)).catch(()=>({}));if(!a||!c||!h)throw Error("Capacitor plugins not available");try{await h.requestPermissions()}catch(t){console.warn("Notification permissions denied",t)}let d=await a.writeFile({path:e,data:r,directory:n.Documents});await h.schedule({notifications:[{title:"Download Complete",body:i,id:Math.floor(1e5*Math.random()),schedule:{at:new Date(Date.now()+100)},sound:null,attachments:null,actionTypeId:"",extra:null}]}),await c.share({title:`Actinova ${s} Download`,text:`${s} for ${l}`,url:d.uri,dialogTitle:"Save or Open PDF"})}catch(o){console.error("Capacitor PDF error:",o),t.save(e)}else t.save(e)},c=async(t,e="course")=>{if(!t)throw Error("No data provided");let o=new l.Ay({orientation:"portrait",unit:"mm",format:"a4"}),c=25,h=(t,e)=>{o.setDrawColor(...a),o.setLineWidth(.2),o.line(20,15,190,15),o.line(20,282,190,282),o.setFont("helvetica","normal"),o.setFontSize(8),o.setTextColor(...r),o.text("Actinova AI Tutor - Personalized Learning",20,287),o.text("Copyright \xa9 Actinova AI Tutor. All rights reserved.",105,287,{align:"center"}),o.text(`Page ${t} of ${e}`,190,287,{align:"right"})},d=t=>c+t>272&&(o.addPage(),c=25,!0);o.setFillColor(255,255,255),o.rect(0,0,210,297,"F"),c=40;try{o.addImage("/logo.png","PNG",85,c,40,40),c+=45}catch(t){c=80}c+=16,o.setTextColor(...s),o.setFont("helvetica","bold"),o.setFontSize(48),o.text("ACTINOVA",105,c,{align:"center"}),c+=12,o.setFontSize(24),o.text("AI TUTOR PLATFORM",105,c,{align:"center"}),c=150;let x=o.splitTextToSize(t.title||"Study Material",150),g=12*x.length;o.setDrawColor(...i),o.setLineWidth(.5),o.roundedRect(15,c-15,180,40+g+20,2,2,"D"),o.setTextColor(...i),o.setFontSize(14),o.text("NOTES"===e.toUpperCase()?"PERSONALIZED STUDY NOTES":"PERSONALIZED COURSE MATERIAL",105,c,{align:"center"}),c+=15,o.setTextColor(...s),o.setFontSize(28),o.text(x,105,c,{align:"center"}),c+=12*x.length+10,o.setFontSize(12),o.setTextColor(...r),o.text(`Generated on ${new Date().toLocaleDateString()}`,105,c,{align:"center"}),o.addPage(),c=30;let p=(t,e,l=11)=>{o.setFontSize(l),o.setFont("helvetica","normal"),o.setTextColor(...s);let i=t.replace(/\[([^\]]+)\]\([^\)]+\)/g,"$1").replace(/https?:\/\/[^\s\)]+/g,"").replace(/\*\*\*([^*]+)\*\*\*/g,"$1").replace(/\*\*([^*]+)\*\*/g,"$1").replace(/\*([^*]+)\*/g,"$1").replace(/__([^_]+)__/g,"$1").replace(/_([^_]+)_/g,"$1").replace(/~~([^~]+)~~/g,"$1").replace(/`([^`]+)`/g,"$1").trim();o.splitTextToSize(i,170-(e-20)).forEach(t=>{d(8),o.text(t,e,c),c+=7})},u=(t,e=null)=>{if(!t)return;let l=t.split("\n"),n=!1,h=!0,x=[],g=()=>{if(0===x.length)return;d(20),c+=5;let t=x.map(t=>t.split("|").map(t=>t.trim()).filter(t=>""!==t));if(t.length<2)return;let e=t[0],l=160/e.length;o.setFillColor(245,247,250),o.rect(20,c,170,10,"F"),o.setFont("helvetica","bold"),o.setFontSize(10),o.setTextColor(...s),e.forEach((t,e)=>{o.text(t,25+e*l,c+6)}),c+=10,o.setFont("helvetica","normal"),t.slice(2).forEach((t,e)=>{d(10),e%2==1&&(o.setFillColor(249,250,251),o.rect(20,c,170,10,"F")),t.forEach((t,e)=>{let i=o.splitTextToSize(t,l-5);o.text(i,25+e*l,c+6)}),o.setDrawColor(230,230,230),o.line(20,c+10,190,c+10),c+=10}),c+=5,x=[]};l.forEach(t=>{let l=t.trim();if(l.startsWith("```")){g(),n="mermaid"===l.substring(3).trim()?"mermaid":!n,c+=2,h=!1;return}if("mermaid"!==n){if(n){o.setFont("courier","normal"),o.setFontSize(10),o.setFillColor(248,250,252),o.rect(22,c-4,166,6,"F"),o.text(t,24,c),c+=6,o.setFont("helvetica","normal"),h=!1;return}if(l.startsWith("|")&&l.endsWith("|"))return void x.push(l);if(g(),!l.startsWith("#")&&!l.startsWith(">")&&(l.includes("---|")||l.includes("/ \\")||l.includes(" +--")||l.includes(" | "))){o.setFont("courier","normal"),d(6),o.text(t,20,c),c+=6,o.setFont("helvetica","normal");return}if(["---","***","___"].includes(l)){d(5),c+=4,h=!1;return}if(!l){c+=5,h=!1;return}if(d(12),l.match(/^#? ?Module:.*/i)){h=!1;return}if(l.startsWith("## LESSON: ")||l.startsWith("LESSON: ")||l.startsWith("Lesson: ")){c+=2,o.setFont("helvetica","bold"),o.setFontSize(20),o.setTextColor(...i);let t=l.replace(/^##\s*/,"").replace(/^LESSON:\s*/i,"");t=t.toUpperCase();let e=o.splitTextToSize(t,170);o.text(e,20,c),c+=10*e.length+2,h=!1;return}if(h&&!l.startsWith("#")&&!l.startsWith("##")&&!l.startsWith("###")&&!l.startsWith("> ")&&!l.match(/^[-*•]\s/)&&!l.match(/^\d+\.\s/)){c+=2,o.setFont("helvetica","bold"),o.setFontSize(26),o.setTextColor(...i);let t=o.splitTextToSize(l,160);o.text(t,20,c),c+=12*t.length+4,h=!1;return}if(h=!1,l.startsWith("# ")){let t=l.substring(2).replace(/[\*_]/g,"").trim();if(e&&t.toLowerCase().includes(e.toLowerCase()))return;c+=2,o.setFont("helvetica","bold"),o.setFontSize(26),o.setTextColor(...i);let s=o.splitTextToSize(t,170);o.text(s,20,c),c+=12*s.length+4}else if(l.startsWith("## ")){c+=2,o.setFont("helvetica","bold"),o.setFontSize(20),o.setTextColor(...i);let t=l.substring(3).replace(/[\*_]/g,"").trim(),e=o.splitTextToSize(t,170);o.text(e,20,c),c+=10*e.length+2}else if(l.startsWith("### ")){c+=2,o.setFont("helvetica","bold"),o.setFontSize(16),o.setTextColor(...s);let t=l.substring(4).replace(/[\*_]/g,"").trim(),e=o.splitTextToSize(t,170);o.text(e,20,c),c+=9*e.length+2}else if(l.startsWith("#### ")){c+=2,o.setFont("helvetica","bold"),o.setFontSize(14),o.setTextColor(...s);let t=l.substring(5).replace(/[\*_]/g,"").trim(),e=o.splitTextToSize(t,170);o.text(e,20,c),c+=8*e.length+2}else if(l.startsWith("> ")){let t=l.substring(2).trim();o.setFont("helvetica","italic"),o.setTextColor(...r);let e=o.splitTextToSize(t,160);d(6*e.length+4),o.setDrawColor(...a),o.setLineWidth(1),o.line(22,c-4,22,c+6*e.length-4),o.text(e,28,c),c+=6*e.length+4,o.setFont("helvetica","normal")}else if(l.match(/^[-*•]\s/))o.setFont("helvetica","bold"),o.setTextColor(...i),o.text("•",22,c),p(l.replace(/^[-*•]\s/,""),28);else if(l.match(/^\d+\.\s/)){let t=l.match(/^\d+\./)[0];o.setFont("helvetica","bold"),o.setTextColor(...i),o.text(t,20,c),p(l.replace(/^\d+\.\s/,""),30)}else p(l,20)}}),g()};if("course"===e){let e=t.modules||t.courseData?.modules||[];o.setFont("helvetica","bold"),o.setFontSize(24),o.setTextColor(...i),o.text("Table of Contents",20,c),c+=15,e.forEach((t,e)=>{d(12),o.setFontSize(12),o.setFont("helvetica","normal"),o.setTextColor(...s),o.text(`Module ${e+1}: ${t.title}`,20,c),c+=8}),e.forEach((t,e)=>{o.addPage(),c=35,t.lessons?.forEach((t,l)=>{d(20),o.setFont("helvetica","bold"),o.setFontSize(16),o.setTextColor(...s),o.text(`${e+1}.${l+1} ${t.title||t}`,20,c),c+=12,t.content&&u(t.content,t.title||t),c+=10})})}else u(t.content,t.title);let T=o.internal.pages.length-1;for(let t=1;t<=T;t++)o.setPage(t),h(t,T);let F=`${t.title?.replace(/\s+/g,"_").toLowerCase()||"actinova_study"}.pdf`;await n(o,F,t.title,`${t.title} saved to Documents. Tap to view.`,"Study Material")},h=async t=>{if(!t||!t.questions)throw Error("No data provided");let e=new l.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=40,c=(o,l)=>{e.setDrawColor(...a),e.setLineWidth(.2),e.line(20,15,190,15),e.setFontSize(8),e.setTextColor(...r),e.text(`Actinova AI Tutor - Assessment: ${t.title}`,20,12),o&&e.text(`Page ${o} of ${l}`,190,12,{align:"right"})};c(),e.setFont("helvetica","bold"),e.setFontSize(24),e.setTextColor(...i),e.text("ASSESSMENT PAPER",105,o,{align:"center"}),o+=12,e.setFontSize(14),e.setTextColor(...r),e.text(`Subject: ${t.topic||"General Knowledge"}`,105,o,{align:"center"}),o+=20,t.questions.forEach((t,l)=>{let i=e.splitTextToSize(`${l+1}. ${t.text}`,160),a=8*(t.options?.length||0);o+6*i.length+a+20>267&&(e.addPage(),c(),o=25),e.setFont("helvetica","bold"),e.setFontSize(12),e.setTextColor(...s),e.text(i,20,o),o+=6*i.length+2,t.options?(e.setFont("helvetica","normal"),e.setFontSize(11),t.options.forEach((t,l)=>{e.setTextColor(...r),e.text(String.fromCharCode(65+l)+")",25,o),e.setTextColor(...s),e.text(e.splitTextToSize(t,150),35,o),o+=6})):o+=10,o+=5}),e.addPage(),c(),o=30,e.setFont("helvetica","bold"),e.setFontSize(18),e.setTextColor(...i),e.text("ANSWER KEY",20,o),o+=15,e.setFontSize(11),t.questions.forEach((t,l)=>{o>277&&(e.addPage(),c(),o=25),e.setFont("helvetica","bold"),e.setTextColor(...s),e.text(`${l+1}: `,20,o),e.setFont("helvetica","normal"),e.setTextColor(...i),e.text(String(t.correctAnswer),30,o),o+=6});let h=e.internal.pages.length-1;for(let t=1;t<=h;t++)e.setPage(t),c(t,h);let d=`assessment_${t.title?.replace(/\s+/g,"_").toLowerCase()||"exam"}.pdf`;await n(e,d,t.title,`Assessment for ${t.title} saved to Documents.`,"Assessment")}}}]);