"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[913],{30913:(t,e,o)=>{o.d(e,{O5:()=>u,n$:()=>p,Iu:()=>f,D6:()=>C});var l=o(18831),i=o(28776);let n=[37,99,235],a=[239,246,255],s=[31,41,55],r=[107,114,128],c=[229,231,235],h=async(t,e,l,i,n="File")=>{if(window.Capacitor||"capacitor:"===window.location.protocol)try{let a=t.output("datauristring").split(",")[1],{Filesystem:s,Directory:r}=await Promise.all([o.e(7805),o.e(8276)]).then(o.bind(o,78276)).catch(()=>({})),{Share:c}=await Promise.all([o.e(7805),o.e(8493)]).then(o.bind(o,98493)).catch(()=>({})),{LocalNotifications:h}=await Promise.all([o.e(7805),o.e(9968)]).then(o.bind(o,59968)).catch(()=>({}));try{let t=await s.requestPermissions();"granted"!==t.publicStorage&&console.warn("Storage permission not granted, falling back to app-specific storage.")}catch(t){}let d=await s.writeFile({path:e,data:a,directory:r.Downloads||r.Documents,recursive:!0});if(h)try{await h.schedule({notifications:[{title:"Download Successful",body:i||`The ${n.toLowerCase()} for "${l}" is now available in your downloads.`,id:Math.floor(1e5*Math.random()),schedule:{at:new Date(Date.now()+500)},sound:null,attachments:[],smallIcon:"res://ic_stat_name",iconColor:"#2563EB"}]})}catch(t){console.error("[PDF] Notification error:",t)}if(c)try{await c.share({title:`${n} Downloaded`,text:`Successfully downloaded ${l}. Find it in your device's Downloads folder.`,url:d.uri,dialogTitle:"Share or Open Document"})}catch(t){console.error("[PDF] Share error:",t)}}catch(o){console.error("Capacitor PDF error (falling back to web save):",o),t.save(e)}else t.save(e)},d=(t,e,o)=>{t.setDrawColor(...c),t.setLineWidth(.1),t.line(20,15,190,15),t.line(20,282,190,282),t.setFont("helvetica","normal"),t.setFontSize(8),t.setTextColor(...r);let l=new Date().getFullYear();t.text(`\xa9 ${l} Actinova AI Tutor - Premium Study Material`,20,287),t.text(`Page ${e} of ${o}`,190,287,{align:"right"})},x=(t,e,o,l,i,n=11,a)=>{t.setFontSize(n),t.setTextColor(...s);let r=e.trim().replace(/^[#\s]+/,"").replace(/\\\[(.*?)\\\]/g,"$1");return t.splitTextToSize(r,i-(o-20)).forEach(e=>{let i=.3527*n*2;l=a(i+2,l);let s=e.split(RegExp("(\\*\\*.*?\\*\\*|__.*?__|(?<!\\*)\\*.*?\\*(?!\\*)|(?<!_)_.*?_(?!_)|~~.*?~~)","g")),r=o;s.forEach(e=>{let o=e.startsWith("**")&&e.endsWith("**")||e.startsWith("__")&&e.endsWith("__"),i=e.startsWith("*")&&e.endsWith("*")||e.startsWith("_")&&e.endsWith("_"),a=e.startsWith("~~")&&e.endsWith("~~");if(o){t.setFont("helvetica","bold");let o=e.slice(2,-2);t.text(o,r,l),r+=t.getTextWidth(o)}else if(i){t.setFont("helvetica","italic");let o=e.slice(1,-1);t.text(o,r,l),r+=t.getTextWidth(o)}else if(a){let o=e.slice(2,-2);t.setFont("helvetica","normal"),t.text(o,r,l);let i=t.getTextWidth(o);t.setLineWidth(.2),t.line(r,l-.12*n,r+i,l-.12*n),r+=i}else t.setFont("helvetica","normal"),t.text(e,r,l),r+=t.getTextWidth(e)}),l+=i}),l},g=(t,e,o)=>o+e>272?(t.addPage(),25):o,F=async(t,e,o,l={})=>{let{margin:i=20,contentWidth:c=170,titleToSkip:h=null,isFirstLesson:d=!0}=l;if(!e)return o;let F=e.split("\n"),u=o,p=!1,f=[],C=[],T="",S=()=>{if(0===f.length)return;u=g(t,25,u)+5;let e=f.map(t=>t.split("|").map(t=>t.trim()).filter(t=>""!==t));if(e.length<2)return;let o=e[0],l=(c-10)/o.length;t.setFillColor(245,247,250),t.rect(i,u,c,10,"F"),t.setFont("helvetica","bold"),t.setFontSize(10),t.setTextColor(...s),o.forEach((e,o)=>t.text(e,i+5+o*l,u+6)),u+=10,t.setFont("helvetica","normal"),e.slice(2).forEach((e,o)=>{u=g(t,10,u),o%2==1&&(t.setFillColor(249,250,251),t.rect(i,u,c,10,"F")),e.forEach((e,o)=>{let n=t.splitTextToSize(e,l-5);t.text(n,i+5+o*l,u+6)}),t.setDrawColor(230,230,230),t.line(i,u+10,210-i,u+10),u+=10}),u+=5,f=[]};for(let e of F){let o=e.trim();if(!o&&!p){u+=6;continue}if(o.startsWith("```")){if(S(),"mermaid"===o.substring(3).trim())p="mermaid",C=[];else if("mermaid"===p){p=!1;let e=C.join("\n");if(e.trim()){let o=await m(e);if(o){let e=o.height/o.width,l=Math.min(c,.2*o.width),i=l*e;u=g(t,i+15,u),t.addImage(o.dataUrl,"PNG",(210-l)/2,u,l,i),u+=i+10}}}else p=!p;continue}if("mermaid"===p){C.push(e);continue}if(p){u=g(t,8,u),t.setFont("courier","normal"),t.setFontSize(10),t.setFillColor(248,250,252),t.rect(i+2,u-4,c-4,6,"F"),t.text(e,i+4,u),u+=6;continue}if(o.startsWith("|")&&o.endsWith("|")){f.push(o);continue}if(S(),u=g(t,12,u),(o.startsWith("# ")||o.startsWith("## "))&&(T=o.replace(/^#+\s*/,"").replace(/[\*_]/g,"").trim()),o.startsWith("# ")){let e=o.substring(2).replace(/[\*_]/g,"").trim();if(h&&e.toLowerCase().includes(h.toLowerCase())&&d)continue;u+=10,t.setFont("helvetica","bold"),t.setFontSize(26),t.setTextColor(...n),t.text(e,i,u),u+=10,t.setDrawColor(...n),t.setLineWidth(.8),t.line(i,u-7,i+t.getTextWidth(e),u-7),u+=5}else if(o.startsWith("## ")){u+=10,t.setFont("helvetica","bold"),t.setFontSize(20),t.setTextColor(...n);let e=o.substring(3).replace(/[\*_]/g,"").trim();t.text(e,i,u),u+=8,t.setDrawColor(...a),t.setLineWidth(.4),t.line(i,u-6,i+c,u-6),u+=4}else if(o.startsWith("### ")){u+=5,t.setFont("helvetica","bold"),t.setFontSize(16),t.setTextColor(...s);let e=o.substring(4).replace(/[\*_]/g,"").trim();t.text(e,i,u),u+=8}else if(o.startsWith("#### ")){u+=10/3,t.setFont("helvetica","bold"),t.setFontSize(13),t.setTextColor(...s);let e=o.substring(5).replace(/[\*_]/g,"").trim();t.text(e,i,u),u+=6}else if(o.startsWith("##### ")){u+=2.5,t.setFont("helvetica","bold"),t.setFontSize(11),t.setTextColor(...s);let e=o.substring(6).replace(/[\*_]/g,"").trim();t.text(e,i,u),u+=5}else if(o.startsWith("###### ")){u+=2,t.setFont("helvetica","bold"),t.setFontSize(10),t.setTextColor(...s);let e=o.substring(7).replace(/[\*_]/g,"").trim();t.text(e,i,u),u+=4}else if(o.startsWith("> ")){let e=o.substring(2).trim();t.setFont("helvetica","italic"),t.setTextColor(...r);let l=t.splitTextToSize(e,c-15);u=g(t,8*l.length+5,u),t.setDrawColor(...n),t.setLineWidth(1.5),t.line(i+2,u-4,i+2,u+8*l.length-4),l.forEach(e=>{t.text(e,i+8,u),u+=8}),u+=5}else if(o.match(/^[-*•]\s/))T.toLowerCase().includes("practice exercises")?(t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("✓",i+2,u),u=x(t,o.replace(/^[-*•]\s/,""),i+10,u,c,11,(e,o)=>g(t,e,o))):(t.setFont("helvetica","bold"),t.setTextColor(...n),t.text("•",i+2,u),u=x(t,o.replace(/^[-*•]\s/,""),i+8,u,c,11,(e,o)=>g(t,e,o)));else if(o.match(/^\d+\.\s/)){let e=o.match(/^\d+\./)[0];t.setFont("helvetica","bold"),t.setTextColor(...n),t.text(e,i,u),u=x(t,o.replace(/^\d+\.\s/,""),i+10,u,c,11,(e,o)=>g(t,e,o))}else u=e.startsWith("    ")||e.startsWith("	")?x(t,o,i+10,u,c,11,(e,o)=>g(t,e,o)):x(t,o,i,u,c,11,(e,o)=>g(t,e,o))}return S(),u},m=async t=>{try{let e=t.replace(/\[([\s\S]*?)\]/g,(t,e)=>/[()",]/.test(e)?`["${e.trim().replace(/"/g,'""')}"]`:t),o=`mermaid-pdf-${Date.now()}-${Math.floor(1e4*Math.random())}`;i.A.initialize({startOnLoad:!1,theme:"default"});let{svg:l}=await i.A.render(o,e);return new Promise(t=>{let e=new Image,o=btoa(unescape(encodeURIComponent(l))),i=`data:image/svg+xml;base64,${o}`;e.onload=()=>{let o=document.createElement("canvas");o.width=3*e.width,o.height=3*e.height;let l=o.getContext("2d");l.fillStyle="#ffffff",l.fillRect(0,0,o.width,o.height),l.scale(3,3),l.drawImage(e,0,0),t({dataUrl:o.toDataURL("image/png"),width:e.width,height:e.height})},e.onerror=()=>t(null),e.src=i})}catch(t){return console.error("Mermaid render error:",t),null}},u=async t=>{if(!t)throw Error("No data provided");let e=new l.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=25;e.setFillColor(255,255,255),e.rect(0,0,210,297,"F"),o=40;try{e.addImage("/logo.png","PNG",85,o,40,40),o+=45}catch(t){o=80}o+=16,e.setTextColor(...s),e.setFont("helvetica","bold"),e.setFontSize(48),e.text("ACTINOVA",105,o,{align:"center"}),o+=12,e.setFontSize(24),e.text("AI TUTOR PLATFORM",105,o,{align:"center"}),o=150;let i=e.splitTextToSize(t.title||"Full Course Material",130),a=40+12*i.length+20;e.setDrawColor(...n),e.setLineWidth(.5),e.roundedRect(20,o-15,170,a,2,2,"D"),e.setTextColor(...n),e.setFontSize(14),e.text("PERSONALIZED COURSE TEXTBOOK",105,o,{align:"center"}),o+=15,e.setTextColor(...s),e.setFontSize(28),e.text(i,105,o,{align:"center",maxWidth:130}),o+=12*i.length+10,e.setFontSize(12),e.setTextColor(...r),e.text(`Generated on ${new Date().toLocaleDateString()}`,105,o,{align:"center"}),e.addPage(),o=25;let c=t.modules||t.courseData?.modules||[];e.setFont("helvetica","bold"),e.setFontSize(24),e.setTextColor(...n),e.text("Table of Contents",20,o),o+=15,c.forEach((t,l)=>{o=g(e,15,o),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(...s),e.text(`Module ${l+1}: ${t.title}`,20,o),o+=8,t.lessons&&t.lessons.forEach((t,i)=>{o=g(e,10,o),e.setFontSize(11),e.setFont("helvetica","normal"),e.setTextColor(...r);let n=t.title||"Untitled Lesson";e.text(`  ${l+1}.${i+1} ${n}`,20,o),o+=7}),o+=4});for(let t=0;t<c.length;t++){let l=c[t];if(e.addPage(),o=30,e.setFont("helvetica","bold"),e.setFontSize(32),e.setTextColor(...n),e.text(`MODULE ${t+1}`,20,o),o+=12,e.setFontSize(20),e.setTextColor(...s),e.text(l.title.toUpperCase(),20,o),o+=20,l.lessons)for(let i=0;i<l.lessons.length;i++){let n=l.lessons[i];o=g(e,40,o),e.setFont("helvetica","bold"),e.setFontSize(18),e.setTextColor(...s);let a=n.title||"Lesson Content";e.text(`${t+1}.${i+1} ${a}`,20,o),o+=10,n.content&&(o=await F(e,n.content,o,{titleToSkip:a,isFirstLesson:!1})),o+=15}}let x=e.internal.pages.length-1;for(let t=1;t<=x;t++)e.setPage(t),d(e,t,x);let m=`${t.title?.replace(/\s+/g,"_").toLowerCase()||"course"}.pdf`,u=`The course textbook for "${t.title}" is now available in your downloads.`;await h(e,m,t.title,u,"Course")},p=async t=>{if(!t||!t.content)throw Error("No content provided");let e=new l.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=25;e.setFillColor(255,255,255),e.rect(0,0,210,297,"F"),o=40;try{e.addImage("/logo.png","PNG",85,o,40,40),o+=45}catch(t){o=80}o+=16,e.setTextColor(...s),e.setFont("helvetica","bold"),e.setFontSize(40),e.text("STUDY NOTES",105,o,{align:"center"}),o=150;let i=e.splitTextToSize(t.title||"Lesson Material",130),a=40+12*i.length+20;e.setDrawColor(...n),e.setLineWidth(.5),e.roundedRect(20,o-15,170,a,2,2,"D"),e.setTextColor(...n),e.setFontSize(14),e.text("PERSONALIZED ACADEMIC CONTENT",105,o,{align:"center"}),o+=15,e.setTextColor(...s),e.setFontSize(28),e.text(i,105,o,{align:"center",maxWidth:130}),o+=12*i.length+10,e.setFontSize(12),e.setTextColor(...r),e.text(`Generated on ${new Date().toLocaleDateString()}`,105,o,{align:"center"}),e.addPage(),o=30,e.setFont("helvetica","bold"),e.setFontSize(22),e.setTextColor(...n),e.text(t.title||"Lesson Material",20,o),o+=12,o=await F(e,t.content,o,{titleToSkip:t.title,isFirstLesson:!0});let c=e.internal.pages.length-1;for(let t=1;t<=c;t++)e.setPage(t),d(e,t,c);let x=`${t.title?.replace(/\s+/g,"_").toLowerCase()||"lesson"}.pdf`;await h(e,x,t.title,"Your lesson notes are ready.","Lesson")},f=async t=>{if(!t||!t.questions)throw Error("No data provided");let e=new l.Ay({orientation:"portrait",unit:"mm",format:"a4"}),o=40,i=(o,l)=>{e.setDrawColor(...c),e.setLineWidth(.1),e.line(20,15,190,15),e.setFontSize(8),e.setTextColor(...r),e.text(`Actinova AI Tutor - Assessment: ${t.title}`,20,12),o&&e.text(`Page ${o} of ${l}`,190,12,{align:"right"})};i(),e.setFont("helvetica","bold"),e.setFontSize(24),e.setTextColor(...n),e.text("ASSESSMENT PAPER",105,o,{align:"center"}),o+=12,e.setFontSize(14),e.setTextColor(...r),e.text(`Subject: ${t.topic||"General Knowledge"}`,105,o,{align:"center"}),o+=20,t.questions.forEach((t,l)=>{let i=e.splitTextToSize(`${l+1}. ${t.text}`,160),n=8*(t.options?.length||0);o=g(e,6*i.length+n+20,o),e.setFont("helvetica","bold"),e.setFontSize(12),e.setTextColor(...s),e.text(i,20,o),o+=6*i.length+4,t.options&&(e.setFont("helvetica","normal"),e.setFontSize(11),t.options.forEach((t,l)=>{e.setTextColor(...r),e.text(String.fromCharCode(65+l)+")",25,o),e.setTextColor(...s),e.text(e.splitTextToSize(t,150),35,o),o+=8})),o+=6}),e.addPage(),i(),o=30,e.setFont("helvetica","bold"),e.setFontSize(18),e.setTextColor(...n),e.text("ANSWER KEY",20,o),o+=15,e.setFontSize(11),t.questions.forEach((t,l)=>{o=g(e,10,o),e.setFont("helvetica","bold"),e.setTextColor(...s),e.text(`${l+1}: `,20,o),e.setFont("helvetica","normal"),e.setTextColor(...n),e.text(String(t.correctAnswer),30,o),o+=10});let a=e.internal.pages.length-1;for(let t=1;t<=a;t++)e.setPage(t),i(t,a);let d=`assessment_${t.title?.replace(/\s+/g,"_").toLowerCase()||"exam"}.pdf`;await h(e,d,t.title,"Assessment downloaded successfully.","Assessment")},C=async(t,e="Scholar")=>{if(!t)throw Error("No data provided");let o=new l.Ay({orientation:"portrait",unit:"mm",format:"a4"}),i=[0,168,255],n=[100,100,100],a=20;try{o.addImage("/logo.png","PNG",92.5,a,25,25),a+=30}catch(t){a+=5}o.setFillColor(0,102,204),o.rect(20,a,170,12,"F"),o.setFont("helvetica","bold"),o.setFontSize(14),o.setTextColor(255,255,255),o.text("Payment Receipt",105,a+8,{align:"center"}),a+=15,o.setTextColor(0,0,0),o.setFontSize(18),o.text("Actinova AI Tutor",105,a,{align:"center"}),a+=6,o.setFont("helvetica","normal"),o.setFontSize(10),o.text("Your Intelligent Learning Companion",105,a,{align:"center"}),a+=8,o.setTextColor(...n),o.text("www.actinova.ai",105,a,{align:"center"}),a+=12,o.setTextColor(0,0,0),o.setFont("helvetica","bold"),o.setFontSize(11),o.text(`Billed To: ${e}`,105,a,{align:"center"}),a+=8,o.setFont("helvetica","bold"),o.text("Thank you for your subscription!",105,a,{align:"center"}),a+=6,o.setDrawColor(...i),o.setLineWidth(.5),o.line(65,a,145,a),a+=20;let s=new Date(t.date||t.paidAt||Date.now()).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});o.setFontSize(10),o.setTextColor(0,0,0);let r=a;o.setFont("helvetica","bold"),o.text("Transaction Date:",20,r),o.setFont("helvetica","normal"),o.text(s,55,r),r+=6,o.setFont("helvetica","bold"),o.text("Receipt Number:",20,r),o.setFont("helvetica","normal"),o.text(t.reference?.slice(-10).toUpperCase()||"ORD-"+Math.floor(1e6*Math.random()),55,r),r+=6,o.setFont("helvetica","bold"),o.text("Reference:",20,r),o.setFont("helvetica","normal"),o.text(t.reference||"N/A",55,r),r+=6,o.setFont("helvetica","bold"),o.text("Payment Status:",20,r),o.setFont("helvetica","bold"),o.setTextColor(0,128,0),o.text("SUCCESS",55,r),r+=6,o.setTextColor(0,0,0),o.setFont("helvetica","bold"),o.text("Payment Method:",20,r),o.setFont("helvetica","normal"),o.text("Credit/Debit Card",55,r);let c=a;o.setFont("helvetica","bold"),o.text("Plan:",110,c),o.setFont("helvetica","normal"),o.text(`${t.plan||"Pro Subscription"}`,140,c),c+=6,o.setFont("helvetica","bold"),o.text("Status:",110,c),o.setFont("helvetica","normal"),o.text("Active",140,c),c+=6,o.setFont("helvetica","bold"),o.text("Auto-Renew:",110,c),o.setFont("helvetica","normal"),o.text("Enabled",140,c),c+=6,o.setFont("helvetica","bold"),o.text("Valid From:",110,c),o.setFont("helvetica","normal"),o.text(s,140,c),a=Math.max(r,c)+25,o.setFont("helvetica","bold"),o.setFontSize(16);let d=new Intl.NumberFormat("en-US",{style:"currency",currency:t.currency||"USD"}).format(t.amount||0);o.text(`Amount Paid: ${d}`,105,a,{align:"center"}),a+=15,o.setFont("helvetica","bold"),o.setFontSize(10);let x=new Date(t.date||t.paidAt||Date.now()).toLocaleTimeString("en-US",{hour12:!1});o.text(`Payment processed on ${s} at ${x} EAT`,105,a,{align:"center"}),a+=12,o.setFont("helvetica","italic"),o.setFontSize(9),o.setTextColor(...n),o.text("This is an auto-generated receipt. No signature required.",105,a,{align:"center"}),a+=10,o.setFont("helvetica","normal"),o.setTextColor(0,0,0),o.text("Questions? Contact us at support@actinova.ai",105,a,{align:"center"}),a+=10,o.setDrawColor(...i),o.setLineWidth(.5),o.line(55,a,155,a),a+=8,o.setFont("helvetica","bold"),o.setFontSize(12),o.text("Thank you for choosing Actinova AI Tutor!",105,a,{align:"center"});let g=`receipt-${t.reference||"transaction"}.pdf`;await h(o,g,t.plan||"Subscription","Your receipt is ready.","Receipt")}}}]);