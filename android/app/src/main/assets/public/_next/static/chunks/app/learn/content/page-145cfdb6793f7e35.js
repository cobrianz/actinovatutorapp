(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2101],{31069:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(78340).A)("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]])},33210:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(78340).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},53961:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(78340).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},65117:(e,t,r)=>{Promise.resolve().then(r.bind(r,96401)),Promise.resolve().then(r.bind(r,72773)),Promise.resolve().then(r.bind(r,71552))},92564:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(78340).A)("message-circle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]])},96401:(e,t,r)=>{"use strict";r.d(t,{default:()=>I});var s=r(95155),a=r(39092),o=r.n(a),l=r(73321),n=r(12115),i=r(98500),d=r.n(i),c=r(78340);let u=(0,c.A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),g=(0,c.A)("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]);var m=r(52484),x=r(6962),b=r(92564),p=r(9921),h=r(66088);let y=(0,c.A)("play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);var f=r(97810),w=r(48368),v=r(49619),k=r(56204),j=r(66609),N=r(98126),$=r(28393),S=r(99799),C=r(75238),L=r(94655),_=r(99776);function I(){(0,l.useParams)();let e=(0,l.useSearchParams)(),t=(0,l.useRouter)(),{user:r,refreshToken:a,fetchUser:i}=(0,$.h)(),{authLoading:c}=(0,S.w)();if(c)return(0,s.jsx)(C.A,{});if(!r)return null;let I=decodeURIComponent(e.get("topic")||""),E=e.get("originalTopic"),P=e.get("format")||"course",T=e.get("difficulty")||"beginner",A=e.get("existing"),D=E?decodeURIComponent(E):I,[F,O]=(0,n.useState)("outline"),[R,z]=(0,n.useState)(new Set),[q,M]=(0,n.useState)(new Set([1])),[J,W]=(0,n.useState)({moduleId:1,lessonIndex:0}),[B,G]=(0,n.useState)(""),[H,U]=(0,n.useState)(!1),[K,Q]=(0,n.useState)(""),[Y,Z]=(0,n.useState)([{type:"ai",message:"Hi! I'm your AI tutor. I'm here to help you understand the concepts better. Feel free to ask me any questions about the lesson!",timestamp:new Date}]),[V,X]=(0,n.useState)(null),[ee,et]=(0,n.useState)(!0),[er,es]=(0,n.useState)(null),[ea,eo]=(0,n.useState)(!1),[el,en]=(0,n.useState)(""),ei=(0,n.useRef)(!1),ed=(0,n.useRef)(new Set),ec=(0,n.useRef)(null),eu=(0,n.useRef)(null),[eg,em]=(0,n.useState)(!1),[ex,eb]=(0,n.useState)(null),[ep,eh]=(0,n.useState)(null),[ey,ef]=(0,n.useState)(!1),[ew,ev]=(0,n.useState)(!1),[ek,ej]=(0,n.useState)([]),[eN,e$]=(0,n.useState)({}),[eS,eC]=(0,n.useState)(!1),eL=()=>{let e=V?._id||`${D}-${P}-${T}`;return`conversation_${e}`},e_=()=>{let e=V?._id||`${D}-${P}-${T}`;return`progress_${e}`},eI=e=>{try{localStorage.setItem(eL(),JSON.stringify(e))}catch(e){}try{fetch("/api/library",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","x-user-id":r?._id||r?.id||r?.idString||""},body:JSON.stringify({action:"saveConversation",courseId:V?._id||null,topic:D,difficulty:T,format:P,messages:e})}).catch(()=>{})}catch(e){}},eE=async()=>{try{let e=localStorage.getItem(eL());if(e)return void Z(JSON.parse(e))}catch{}try{let e=await fetch("/api/library",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","x-user-id":r?._id||r?.id||r?.idString||""},body:JSON.stringify({action:"getConversation",courseId:V?._id||null,topic:D,difficulty:T,format:P})});if(e.ok){let t=await e.json();if(Array.isArray(t.messages)&&t.messages.length){Z(t.messages);try{localStorage.setItem(eL(),JSON.stringify(t.messages))}catch{}}}}catch{}};(0,n.useEffect)(()=>{if(V?._id){eE();let e=localStorage.getItem(e_());e&&z(new Set(JSON.parse(e)))}},[V?._id]),(0,n.useEffect)(()=>{eu.current&&(eu.current.scrollTop=eu.current.scrollHeight)},[Y]);let[eP,eT]=(0,n.useState)("notes");(0,n.useEffect)(()=>{window.innerWidth>=1024?(ef(!0),ev(!0)):(ef(!0),ev(!1))},[]);let eA=async(e,t)=>{W({moduleId:e,lessonIndex:t}),window.innerWidth<1024&&ef(!1);let r=V?.modules?.find(t=>t.id===e),s=r?.lessons?.[t],a=`lesson_${D}_${T}_${e}_${t}`,o=localStorage.getItem(a);o&&""!==o.trim()&&"Content for this lesson is coming soon..."!==o.trim()?X(r=>{let s={...r};return s.modules&&s.modules[e-1]&&s.modules[e-1].lessons[t]&&(s.modules[e-1].lessons[t].content=o),s}):s&&(!s.content||""===s.content.trim()||"Content will be generated when you start the lesson."===s.content)&&await eD(e,t,s.title,r.title)},eD=async(e,t,r,s)=>{try{eo(!0),en("");let a=await fetch("/api/course-agent",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"generateLesson",courseId:V?._id||null,moduleId:e,lessonIndex:t,lessonTitle:r,moduleTitle:s,courseTopic:I,difficulty:T})});if(!a.ok)throw Error("Failed to generate lesson content");let o=await a.json();X(r=>{let s={...r};return s.modules&&s.modules[e-1]&&s.modules[e-1].lessons[t]&&(s.modules[e-1].lessons[t].content=o.content),s});let l=`lesson_${D}_${T}_${e}_${t}`;try{localStorage.setItem(l,o.content),window.dispatchEvent(new Event("usageUpdated"))}catch(e){}en(o.content)}catch(r){j.oR.error("Failed to load lesson content"),X(r=>{let s={...r};return s.modules&&s.modules[e-1]&&s.modules[e-1].lessons[t]&&(s.modules[e-1].lessons[t].content="Failed to load content. Please try again."),s})}finally{eo(!1)}},eF=async(e,t)=>{let s=`${e}-${t}`,a=new Set(R);a.has(s)?a.delete(s):a.add(s),z(a);try{if(localStorage.setItem(e_(),JSON.stringify(Array.from(a))),V?._id){let e=V?.totalLessons||0,t=e>0?Math.round(a.size/e*100):0,o=await fetch("/api/course-progress",{method:"POST",headers:{"Content-Type":"application/json","x-user-id":r?._id||r?.id||r?.idString||""},credentials:"include",body:JSON.stringify({courseId:V._id,progress:t,completed:100===t,isLessonCompleted:a.has(s),userId:r?._id||r?.id||null,lessonId:s})});if(!o.ok)throw Error(`Failed to save progress: ${o.statusText}`)}}catch(e){j.oR.error("Failed to save progress to the cloud.")}},eO=async()=>{if(!K.trim())return;if(!(r?.subscription&&("pro"===r.subscription.plan||"enterprise"===r.subscription.plan)&&"active"===r.subscription.status||r?.isPremium)){let e=`ai_responses_${new Date().toDateString()}`,t=parseInt(localStorage.getItem(e)||"0",10);if(t>=3)return void j.oR.error("Daily AI tutor limit reached (3 responses of â‰¤50 words). Upgrade to Pro for unlimited responses.");localStorage.setItem(e,String(t+1))}let e={type:"user",message:K,timestamp:new Date};Z(t=>{let r=[...t,e];return eI(r),r}),Q("");let t={type:"ai",message:"Thinking...",timestamp:new Date,isLoading:!0};Z(e=>{let r=[...e,t];return eI(r),r});try{let t=V?.modules?.flatMap(e=>e.lessons?.map(t=>({moduleTitle:e.title,lessonTitle:t.title,content:t.content||""}))||[]).map(e=>`Module: ${e.moduleTitle}
Lesson: ${e.lessonTitle}
Content: ${e.content}`).join("\n\n---\n\n")||"",r=await fetch("/api/course-agent",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({action:"checkRelevance",question:e.message,courseContent:t,lessonTitle:eJ?.title||"",context:`Course: ${V?.title||""}, Level: ${V?.level||""}, Topic: ${I}. Module: ${V?.modules?.find(e=>e.id===J.moduleId)?.title||""}`})});if(!r.ok)throw Error("Failed to check question relevance");if(!(await r.json()).relevant){let e=V?.title||"this course";Z(t=>{let r=[...t.filter(e=>!e.isLoading),{type:"ai",message:`I'm here to help with this course on **${e}**. What would you like to know about it?`,timestamp:new Date}];return eI(r),r});return}let s=await fetch("/api/course-agent",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({action:"answer",question:e.message,courseContent:t,lessonTitle:eJ?.title||"",context:`Course: ${V?.title||""}, Level: ${V?.level||""}, Topic: ${I}. Module: ${V?.modules?.find(e=>e.id===J.moduleId)?.title||""}`})});if(!s.ok)throw Error("Failed to get AI response");let a=await s.json();Z(e=>{let t=e.filter(e=>!e.isLoading),r=eR(a.response||""),s=[...t,{type:"ai",message:r,html:!0,timestamp:new Date}];return eI(s),s})}catch(e){Z(e=>{let t=[...e.filter(e=>!e.isLoading),{type:"ai",message:"I'm sorry, I'm having trouble responding right now. Please try again later.",timestamp:new Date}];return eI(t),t})}},eR=e=>{if(!e)return"";let t=e,r=[];t=t.replace(/```(\w+)?\s*\n([\s\S]*?)```/g,(e,t,s)=>{let a=`___CODEBLOCK_${r.length}___`;return r.push(`<pre class="bg-gray-900 dark:bg-gray-950 p-4 rounded-lg overflow-x-auto my-4 border border-gray-700"><code class="text-sm text-green-400 language-${t||"plaintext"}">${s.trim().replace(/</g,"&lt;").replace(/>/g,"&gt;")}</code></pre>`),a});let s=[];t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/`([^`]+)`/g,(e,t)=>{let r=`___INLINECODE_${s.length}___`;return s.push(`<code class="bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded text-sm font-mono text-blue-600 dark:text-blue-400">${t}</code>`),r})).replace(/\$\$([\s\S]*?)\$\$/g,'<div class="my-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-center"><span class="text-lg font-serif italic text-gray-900 dark:text-gray-100">$1</span></div>')).replace(/\$([^\$\n]+)\$/g,'<span class="font-serif italic text-blue-600 dark:text-blue-400 mx-1">$1</span>')).replace(/^# (.*$)/gm,'<h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6 mt-8 border-b-2 border-blue-500 pb-2">$1</h1>')).replace(/^## (.*$)/gm,'<h2 class="text-2xl font-semibold text-gray-900 dark:text-gray-100 mb-4 mt-6">$1</h2>')).replace(/^### (.*$)/gm,'<h3 class="text-xl font-semibold text-gray-800 dark:text-gray-200 mb-3 mt-5">$1</h3>')).replace(/^#### (.*$)/gm,'<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-2 mt-4">$1</h4>')).replace(/^> (.*$)/gm,'<blockquote class="border-l-4 border-blue-500 pl-4 py-2 my-4 bg-blue-50 dark:bg-blue-900/20 text-gray-700 dark:text-gray-300 italic rounded-r">$1</blockquote>')).replace(/\*\*([^\*\n]+?)\*\*/g,'<strong class="font-bold text-gray-900 dark:text-gray-100">$1</strong>')).replace(/\*([^\*\n]+?)\*/g,'<em class="italic text-gray-800 dark:text-gray-200">$1</em>');let a=!1;t=t.split("\n").map(e=>{if(/^\d+\.\s+/.test(e)){let t=e.replace(/^\d+\.\s+/,"");return a?'<li class="mb-2">'+t+"</li>":(a=!0,'<ol class="list-decimal list-inside mb-4 space-y-2 text-gray-700 dark:text-gray-300 ml-4"><li class="mb-2">'+t+"</li>")}return a?(a=!1,"</ol>"+e):e}).join("\n"),a&&(t+="</ol>");let o=!1;return t=t.split("\n").map(e=>{if(/^[-â€¢*]\s+/.test(e)){let t=e.replace(/^[-â€¢*]\s+/,"");return o?'<li class="mb-2">'+t+"</li>":(o=!0,'<ul class="list-disc list-inside mb-4 space-y-2 text-gray-700 dark:text-gray-300 ml-4"><li class="mb-2">'+t+"</li>")}return o?(o=!1,"</ul>"+e):e}).join("\n"),o&&(t+="</ul>"),t=(t=t.split("\n\n").map(e=>(e=e.trim())&&!e.startsWith("<")?`<p class="mb-4 text-gray-700 dark:text-gray-300 leading-relaxed">${e}</p>`:e).join("\n")).replace(/^---+$/gm,'<hr class="my-6 border-gray-300 dark:border-gray-600" />'),r.forEach((e,r)=>{t=t.replace(`___CODEBLOCK_${r}___`,e)}),s.forEach((e,r)=>{t=t.replace(`___INLINECODE_${r}___`,e)}),t},ez=V&&V.modules?V.modules.reduce((e,t)=>e+t.lessons.length,0):0,eq=R.size,eM=ez>0?eq/ez*100:0,eJ=(()=>{if(!V||!V.modules)return null;let e=V.modules.find(e=>e.id===J.moduleId);if(!e)return null;let t=e.lessons[J.lessonIndex];return"string"==typeof t?{title:t,content:"Content for this lesson is coming soon..."}:t})(),eW=async e=>{if(e.trim())try{U(!0);let t=await fetch("/api/notes",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemId:`course_${V?._id}`,lessonId:`${J.moduleId}-${J.lessonIndex}`,content:e,title:eJ?.title||"Lesson Notes"})});if(!t.ok)throw Error("Failed to save notes");let r=await t.json();console.log("Notes saved:",r.message),j.oR.success("Notes saved")}catch(e){console.error("Error saving notes:",e),j.oR.error("Failed to save notes")}finally{U(!1)}},eB=async()=>{if(!B||!B.trim())return void j.oR.error("No notes to download");let e={title:eJ?.title||"Lesson Notes",content:B,date:new Date().toLocaleDateString(),course:V.title,tags:["Learning",V?.level||"General"]};j.oR.loading("Preparing your study notes PDF...",{id:"downloading-notes"});try{await (0,N.O)(e,"notes"),j.oR.success("Notes downloaded successfully!",{id:"downloading-notes"})}catch(e){console.error("PDF download error:",e),j.oR.error("Failed to generate PDF. Please try again.",{id:"downloading-notes"})}};return((0,n.useEffect)(()=>{if(B.trim()&&V){let e=setTimeout(()=>{eW(B)},2e3);return()=>clearTimeout(e)}},[B,V,J]),(0,n.useEffect)(()=>{let s=`${D}/${P}/${T}`;ed.current.clear();let a=!0;return(async()=>{let o,l;if(ei.current)return console.log("Fetch already in progress, skipping");ei.current=!0,console.log("Setting isLoading to true"),et(!0),es(null);let n=!!(r?.subscription&&("pro"===r.subscription.plan||"enterprise"===r.subscription.plan)&&"active"===r.subscription.status)||!!r?.isPremium;try{let e=Object.keys(localStorage).filter(e=>e.startsWith("lesson_"));if(e.length>50){let t=e.sort((e,t)=>Math.random()-.5).slice(50);t.forEach(e=>{localStorage.removeItem(e)}),console.log(`ðŸ§¹ Cleaned up ${t.length} old lesson entries from localStorage`)}}catch(e){console.warn("Failed to cleanup localStorage:",e)}try{let e=await fetch("/api/library",{credentials:"include",headers:{"Content-Type":"application/json","x-user-id":r?._id||r?.id||r?.idString||""}});if(e.ok){let t=await e.json(),r=t.items?.find(e=>{if("course"!==e.type)return!1;let t=e.topic?.toLowerCase()===D.toLowerCase()||e.originalTopic?.toLowerCase()===D.toLowerCase()||e.courseData?.topic?.toLowerCase()===D.toLowerCase(),r=e.difficulty?.toLowerCase()===T.toLowerCase()||e.level?.toLowerCase()===T.toLowerCase()||e.courseData?.difficulty?.toLowerCase()===T.toLowerCase()||e.courseData?.level?.toLowerCase()===T.toLowerCase();return t&&r});if(r&&(r.modules&&r.modules.length>0||r.courseData?.modules&&r.courseData.modules.length>0)){if(console.log("âœ… Found existing course in library:",r.title||r.courseData?.title),!a)return;let e=r.courseData||r,t={...e};X(t);let o=new Set;e.modules&&e.modules.forEach(e=>{e.lessons&&e.lessons.forEach(e=>{e.completed&&e.id&&o.add(e.id)})});let l=e._id||`${D}-${P}-${T}`,n=`progress_${l}`,i=localStorage.getItem(n);if(i)try{JSON.parse(i).forEach(e=>o.add(e)),console.log("âœ… Restored completed lessons from DB and localStorage:",Array.from(o))}catch(e){console.warn("Failed to parse saved progress:",e)}else console.log("âœ… Restored completed lessons from DB:",Array.from(o));z(o),console.log("âœ… Found course in library, setting isLoading to false"),console.log("Setting isLoading to false (library)"),et(!1),window.dispatchEvent(new CustomEvent("actinova:loading-done")),setTimeout(()=>{let e=document.querySelectorAll("[data-actinova-loader-overlay], [data-actinova-loader]");e.length&&(console.warn("Detected leftover loaders after library load, removing...",e.length),e.forEach(e=>e.remove()))},1e3),ei.current=!1,ed.current.add(s);return}console.log("generating course...")}}catch(e){console.log("Library check error:",e)}if("flashcards"===P)try{let e=await fetch("/api/flashcards",{credentials:"include",headers:{"Content-Type":"application/json"},cache:"no-store"});if(e.ok){let t=await e.json();console.log("Flashcards data received:",t);let r=t.find(e=>{let t=e.topic?.toLowerCase()===D.toLowerCase()||e.originalTopic?.toLowerCase()===D.toLowerCase(),r=e.difficulty?.toLowerCase()===T.toLowerCase()||e.level?.toLowerCase()===T.toLowerCase();return console.log("Checking card set:",e.title,{matchesTopic:t,matchesDifficulty:r,cardTopic:e.topic||e.originalTopic,cardDifficulty:e.difficulty||e.level}),t&&r});if(r){console.log("âœ… Loading existing questions:",r.title,"Cards:",r.totalCards),X(r),console.log("âœ… Found questions in library, setting isLoading to false"),et(!1),ei.current=!1,ed.current.add(s);return}console.log("âŒ Question set not found in cards collection")}}catch(e){console.log("Cards check error:",e)}if("quiz"===P&&A)try{let e=await fetch(`/api/quizzes/${A}`);if(e.ok){let t=await e.json();X(t),console.log("âœ… Loaded existing quiz:",t.title),et(!1),ei.current=!1,ed.current.add(s);return}}catch(e){console.log("Error loading existing quiz:",e)}if(!n&&"beginner"!==T){j.oR.error("Intermediate and Advanced levels require Pro subscription. Redirecting to upgrade..."),t.push("/dashboard?tab=upgrade"),console.log("âœ… Free user trying non-beginner difficulty, setting isLoading to false and redirecting"),console.log("Setting isLoading to false (free user redirect)"),et(!1),ei.current=!1,ed.current.add(s);return}"quiz"===P?(o="/api/generate-course",l={topic:D,format:"quiz",difficulty:n?T:"beginner",questions:parseInt(e.get("questions"))||10}):"flashcards"===P?(o="/api/generate-flashcards",l={topic:D,format:P,difficulty:n?T:"beginner"}):(o="/api/generate-course",l="guide"===P?{topic:D,difficulty:(n?T:"beginner").toLowerCase()}:{topic:D,format:P,difficulty:(n?T:"beginner").toLowerCase()});try{let e,t=await fetch(o,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!t.ok){if(429===t.status){let e=await t.json();if(!a)return;eb({used:e.used||0,limit:e.limit||2,isPremium:e.isPremium||!1}),em(!0),et(!1),ei.current=!1;return}let e=await t.json();throw Error(e.error||"Failed to generate course")}let n=await t.json();if(n.content?e=n.content:(n.modules,e=n),"course"===P){if(!(Array.isArray(e.modules)&&e.modules.length>0||Array.isArray(e.topics)&&e.topics.length>0))throw console.error("Course generation failed: Invalid structure"),Error("Generated course structure is invalid. Please try again.")}else if("quiz"===P&&!(Array.isArray(e.questions)&&e.questions.length>0))throw Error("Generated quiz has no questions. Please try again.");n.courseId&&(e._id=n.courseId),X(e),et(!1),window.dispatchEvent(new CustomEvent("actinova:loading-done")),setTimeout(()=>{window.dispatchEvent(new CustomEvent("actinova:loading-done"))},50),setTimeout(()=>{let e=document.querySelectorAll("[data-actinova-loader-overlay], [data-actinova-loader]");e.length&&(console.warn("Detected leftover loaders after generation, removing...",e.length),e.forEach(e=>e.remove()))},1e3);try{(await fetch("/api/library",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","x-user-id":r?._id||r?.id||r?.idString||""},body:JSON.stringify({action:"add",course:{isGenerated:!0,courseData:e,title:e.title,topic:e.topic||D,level:e.level||T,format:P}})})).ok||console.warn("Failed to store course in library")}catch(e){console.warn("Error storing course in library:",e)}try{await i(),window.dispatchEvent(new CustomEvent("usageUpdated"))}catch(e){console.warn("Failed to refresh user usage after generation",e)}ed.current.add(s),console.log("Course data set successfully")}catch(e){console.error("Error fetching course data:",e),a&&(es(e.message),j.oR.error(`Failed to load course: ${e.message}`))}finally{console.log("Finally block executed, setting isLoading to false"),a&&(console.log("Setting isLoading to false (finally)"),et(!1),window.dispatchEvent(new CustomEvent("actinova:loading-done")),setTimeout(()=>{let e=document.querySelectorAll("[data-actinova-loader-overlay], [data-actinova-loader]");e.length&&(console.warn("Detected leftover loaders in finally block, removing...",e.length),e.forEach(e=>e.remove()))},1e3)),ei.current=!1}setTimeout(()=>{a&&ei.current&&(console.log("Safety timeout: forcing isLoading to false"),et(!1),ei.current=!1,window.dispatchEvent(new CustomEvent("actinova:loading-done")),setTimeout(()=>{let e=document.querySelectorAll("[data-actinova-loader-overlay], [data-actinova-loader]");e.length&&(console.warn("Detected leftover loaders from safety timeout, removing...",e.length),e.forEach(e=>e.remove()))},1e3))},3e4)})(),()=>{a=!1}},[D,P,T]),(0,n.useEffect)(()=>{!V||100==eq/ez*100&&eq>0&&(Date.now(),V.title,new Date().toLocaleDateString(),V.level,j.oR.success("\uD83C\uDF89 Congratulations! You've completed the course!"))},[eq,ez,V]),(0,n.useLayoutEffect)(()=>{V&&ee&&et(!1)},[V,ee]),ee&&!V)?(0,s.jsx)(C.A,{text:"quiz"===P?"Generating your test":"guide"===P?"Generating your questions":"Generating your course"}):er?(0,s.jsx)("div",{className:"h-[calc(100vh-6rem)] flex flex-col bg-gray-50 dark:bg-gray-900 overflow-hidden",children:(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,s.jsx)("div",{className:"text-red-500 mb-4",children:(0,s.jsx)("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Failed to generate course"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:er}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]})})}):V?"flashcards"===P?(0,s.jsx)(L.A,{cardData:V}):"quiz"===P?(0,s.jsx)(_.A,{quizData:V,topic:I,existingQuizId:A}):(0,s.jsxs)("div",{className:"h-screen flex flex-col bg-gray-50 dark:bg-gray-900 overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-3 sm:p-4 z-50 shadow-sm relative",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full px-2 sm:px-4 lg:px-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[(0,s.jsxs)(d(),{href:"/dashboard",className:"flex items-center space-x-2 px-3 py-1.5 text-xs sm:text-sm rounded-sm bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900 hover:opacity-90 transition-all font-bold shadow-sm",children:[(0,s.jsx)(u,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"hidden md:inline",children:"Dashboard"})]}),(0,s.jsxs)("button",{onClick:()=>ef(!ey),className:`flex items-center space-x-2 px-3 py-1.5 text-xs sm:text-sm rounded-lg border transition-all font-medium ${ey?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 border-blue-200 dark:border-blue-900/50":"bg-gray-50 dark:bg-gray-700/50 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700"}`,children:[(0,s.jsx)(g,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"hidden md:inline",children:"Modules"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[(0,s.jsxs)("button",{onClick:async()=>{if(!J||ea)return;let e=`${J.moduleId}-${J.lessonIndex}`,t=R.has(e)?"incomplete":"complete";j.oR.loading(`Marking lesson as ${t}...`,{id:"mark-complete"});try{await eF(J.moduleId,J.lessonIndex),j.oR.success(`Lesson marked as ${t}!`,{id:"mark-complete"})}catch(e){j.oR.error(`Error: ${e.message}`,{id:"mark-complete"})}},className:`flex items-center space-x-2 px-3 py-1.5 text-xs sm:text-sm rounded-lg transition-all font-medium border ${R.has(`${J.moduleId}-${J.lessonIndex}`)?"bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 border-orange-200 dark:border-orange-900/50":"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 border-green-200 dark:border-green-900/50"}`,disabled:!eJ?.content||ea,children:[(0,s.jsx)(m.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"hidden md:inline",children:R.has(`${J.moduleId}-${J.lessonIndex}`)?"Mark Incomplete":"Mark Complete"})]}),(0,s.jsxs)("button",{onClick:()=>{if(!(r&&(r.subscription?.plan==="pro"&&r.subscription?.status==="active"||r.isPremium))){j.oR.error("Lesson PDF export is a Pro feature. Please upgrade."),t.push("/dashboard?tab=upgrade");return}eJ?.content?((0,N.O)({title:eJ.title,content:eJ.content},"notes"),j.oR.success("Download started!")):j.oR.error("No lesson content to download.")},className:"flex items-center space-x-2 px-3 py-1.5 text-xs sm:text-sm rounded-lg bg-gray-50 dark:bg-gray-700/50 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-all font-medium",children:[(0,s.jsx)(x.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"hidden md:inline",children:"Download Lesson"})]}),(0,s.jsxs)("button",{onClick:()=>ev(!ew),className:`flex items-center space-x-2 px-3 py-1.5 text-xs sm:text-sm rounded-lg border transition-all font-medium ${ew?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 border-blue-200 dark:border-blue-900/50":"bg-gray-50 dark:bg-gray-700/50 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700"}`,children:[(0,s.jsx)(b.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"hidden md:inline",children:ew?"Hide Tools":"Show Tools"})]})]})]})}),(0,s.jsxs)("div",{className:"flex flex-1 overflow-hidden relative",children:[ey&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-30 lg:hidden",onClick:()=>ef(!1)}),ew&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-30 lg:hidden",onClick:()=>ev(!1)}),(0,s.jsxs)("div",{className:`${ey?"translate-x-0":"-translate-x-full"} w-full lg:w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col absolute z-40 transition-transform duration-300 max-w-[90vw] md:max-w-[400px] h-full overflow-y-auto hide-scrollbar shadow-xl`,children:[(0,s.jsxs)("div",{className:"p-4 lg:p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,s.jsx)("div",{className:"flex justify-between flex-wrap flex-col",children:(0,s.jsx)("h2",{className:"font-bold text-lg text-gray-900 dark:text-gray-100 mb-2",children:V.title})}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[V.totalModules," modules â€¢ ",V.totalLessons," ","lessons"]}),(0,s.jsxs)("button",{onClick:()=>{if(!(r&&(r.subscription&&"pro"===r.subscription.plan&&"active"===r.subscription.status||r.isPremium))){j.oR.error("PDF downloads are a Pro feature. Please upgrade."),t.push("/dashboard?tab=upgrade");return}try{(0,N.O)(V,P),j.oR.success("PDF download started!")}catch(e){console.error("Error downloading PDF:",e),j.oR.error("Failed to download PDF")}},disabled:!(r&&(r.subscription&&"pro"===r.subscription.plan&&"active"===r.subscription.status||r.isPremium)),className:r&&(r.subscription&&"pro"===r.subscription.plan&&"active"===r.subscription.status||r.isPremium)?"w-full mb-4 flex items-center justify-center space-x-2 px-4 py-2 rounded-lg transition-colors text-sm font-medium bg-blue-600 text-white hover:bg-blue-700":"w-full mb-4 flex items-center justify-center space-x-2 px-4 py-2 rounded-lg transition-colors text-sm font-medium bg-gray-300 dark:bg-gray-700 text-gray-600 dark:text-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)(x.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:r&&(r.subscription&&"pro"===r.subscription.plan&&"active"===r.subscription.status||r.isPremium)?`Download ${"flashcards"===P?"Flashcards":"Course"} as PDF`:"Upgrade to Pro for PDF"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,s.jsxs)("div",{className:"w-8 h-8 bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-400 rounded-full flex items-center justify-center text-sm font-semibold",children:[Math.round(eM),"%"]}),(0,s.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completed"})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${eM}%`}})})]}),(0,s.jsx)("div",{className:"flex-1",children:Array.isArray(V.modules)&&V.modules.map((e,t)=>(0,s.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[(0,s.jsxs)("button",{onClick:()=>{var t;let r;return t=e.id,void((r=new Set(q)).has(t)?r.delete(t):r.add(t),M(r))},className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center text-sm font-medium",children:t+1}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 text-left",children:e.title})]}),q.has(e.id)?(0,s.jsx)(p.A,{className:"w-4 h-4 text-gray-400"}):(0,s.jsx)(h.A,{className:"w-4 h-4 text-gray-400"})]}),q.has(e.id)&&(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700",children:e.lessons.map((t,r)=>{let a="string"==typeof t?t:t.title,o=`${e.id}-${r}`,l=R.has(o),n=J.moduleId===e.id&&J.lessonIndex===r;return(0,s.jsxs)("button",{onClick:()=>eA(e.id,r),className:`w-full p-3 pl-12 flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors ${n?"bg-blue-50 dark:bg-blue-900/20 border-r-2 border-blue-500":""}`,children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center text-xs font-medium ${l?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400"}`,children:l?"âœ“":r+1}),(0,s.jsx)("span",{className:`text-sm text-left ${n?"text-blue-600 dark:text-blue-400 font-medium":"text-gray-700 dark:text-gray-300"}`,children:a})]}),!l&&(0,s.jsx)(y,{className:"w-4 h-4 text-gray-400"})]},r)})})]},e?.id??t))})]}),(0,s.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:(0,s.jsx)("div",{ref:ec,className:"flex-1 overflow-y-auto hide-scrollbar bg-white dark:bg-gray-800",children:(0,s.jsx)("div",{className:`mx-auto p-4 sm:p-6 lg:p-8 transition-all duration-300 ${ew&&ey?"max-w-4xl":"max-w-5xl"}`,children:ea?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Generating lesson content..."}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Please wait while we create personalized content for you"})]}):eJ?.content?(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"prose prose-sm sm:prose-base lg:prose-lg dark:prose-invert max-w-none",children:(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:eR(eJ.content)}})})}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(f.A,{className:"w-12 h-12 text-blue-500 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Select a lesson to start learning"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Choose a lesson from the sidebar to begin"})]})})})}),(0,s.jsxs)("div",{className:`${ew?"translate-x-0":"translate-x-full"} w-full lg:w-80 xl:w-96 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 flex flex-col absolute z-40 transition-transform duration-300 max-w-[100vw] md:max-w-[400px] right-0 h-full shadow-xl`,children:[(0,s.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 relative",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("button",{onClick:()=>eT("notes"),className:`flex-1 px-3 py-2 sm:px-4 sm:py-3 text-xs sm:text-sm font-medium border-b-2 transition-colors ${"notes"===eP?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"}`,children:[(0,s.jsx)(w.A,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1 sm:mr-2"}),"Notes"]}),(0,s.jsxs)("button",{onClick:()=>eT("chat"),className:`flex-1 px-3 py-2 sm:px-4 sm:py-3 text-xs sm:text-sm font-medium border-b-2 transition-colors ${"chat"===eP?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"}`,children:[(0,s.jsx)(b.A,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1 sm:mr-2"}),"AI Tutor"]})]})}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden",children:"notes"===eP?(0,s.jsxs)("div",{className:"h-full flex flex-col",children:[(0,s.jsxs)("div",{className:"p-3 sm:p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,s.jsx)("h3",{className:"font-semibold text-sm sm:text-base text-gray-900 dark:text-gray-100",children:"My Notes"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:"Take notes while learning"})]}),(0,s.jsxs)("div",{className:"flex-1 p-3 sm:p-4",children:[(0,s.jsx)("textarea",{value:B,onChange:e=>G(e.target.value),placeholder:"Write your notes here... remember to download them before leaving this page!!",className:"w-full h-full resize-none overflow-y-auto hide-scrollbar bg-transparent text-sm sm:text-base text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400",dir:"ltr",style:{direction:"ltr",unicodeBidi:"plaintext"}}),H&&(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Saving..."})]}),(0,s.jsx)("div",{className:"p-3 sm:p-4 border-t border-gray-200 dark:border-gray-700",children:(0,s.jsxs)("button",{onClick:()=>{if(!(r&&(r.subscription&&"pro"===r.subscription.plan&&"active"===r.subscription.status||r.isPremium))){j.oR.error("Notes PDF export is a Pro feature. Please upgrade."),t.push("/dashboard?tab=upgrade");return}eB()},disabled:!B.trim()||!(r&&(r.subscription&&"pro"===r.subscription.plan&&"active"===r.subscription.status||r.isPremium)),className:r&&(r.subscription&&"pro"===r.subscription.plan&&"active"===r.subscription.status||r.isPremium)?"w-full flex items-center justify-center space-x-1 sm:space-x-2 py-1.5 sm:py-4 px-3 sm:px-4 text-sm rounded-lg transition-colors sm:p-x3 bg-blue-600 text-white hover:bg-blue-700":"w-full flex items-center justify-center space-x-1 sm:space-x-2 py-1.5 sm:py-4 px-3 sm:px-4 text-sm rounded-lg disabled:opacity-50 transition-colors sm:p-x3 bg-gray-300 dark:bg-gray-700 text-gray-600 dark:text-gray-400",children:[(0,s.jsx)(x.A,{className:"w-3 h-3 sm:w-4 sm:h-4"}),(0,s.jsx)("span",{children:r&&(r.subscription&&"pro"===r.subscription.plan&&"active"===r.subscription.status||r.isPremium)?"Download Notes":"Pro: Notes PDF"})]})})]}):(0,s.jsxs)("div",{className:"h-full flex flex-col bg-[#e5ddd5] dark:bg-[#0b141a] relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute inset-0 opacity-[0.05] dark:opacity-[0.03] pointer-events-none",style:{backgroundImage:'url("https://www.transparenttextures.com/patterns/cubes.png")',backgroundRepeat:"repeat"}}),(0,s.jsx)("div",{className:"p-3 sm:p-4 border-b border-gray-200/50 dark:border-gray-700/50 bg-white/80 dark:bg-gray-800/80 backdrop-blur-md z-10 flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-semibold text-sm sm:text-base text-gray-900 dark:text-gray-100 flex items-center",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"}),"AI Tutor"]}),(0,s.jsx)("p",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400",children:"Online & ready to help"})]})}),(0,s.jsxs)("div",{ref:eu,className:"jsx-c56b0bdabd8066c1 flex-1 overflow-y-auto scrollbar-hide p-3 sm:p-4 space-y-3 z-10",children:[(0,s.jsx)(o(),{id:"c56b0bdabd8066c1",children:".scrollbar-hide.jsx-c56b0bdabd8066c1::-webkit-scrollbar{display:none}"}),Y.map((e,t)=>{let r="user"===e.type,a=e.timestamp?new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return(0,s.jsx)("div",{className:`jsx-c56b0bdabd8066c1 flex ${r?"justify-end":"justify-start"} animate-in fade-in slide-in-from-bottom-2 duration-300`,children:(0,s.jsxs)("div",{className:`jsx-c56b0bdabd8066c1 max-w-[85%] px-3 py-2 rounded-xl text-sm relative shadow-sm ${r?"bg-[#dcf8c6] dark:bg-[#005c4b] text-gray-800 dark:text-gray-100 rounded-tr-none":"bg-white dark:bg-[#202c33] text-gray-900 dark:text-gray-100 rounded-tl-none"}`,children:[!r&&(0,s.jsxs)("div",{className:"jsx-c56b0bdabd8066c1 flex items-center space-x-2 mb-1 opacity-70",children:[(0,s.jsx)(v.A,{className:"w-3 h-3 text-blue-500"}),(0,s.jsx)("span",{className:"jsx-c56b0bdabd8066c1 text-[10px] font-bold uppercase tracking-wider",children:"AI Tutor"})]}),e.html?(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:e.message},className:"jsx-c56b0bdabd8066c1 prose prose-sm dark:prose-invert max-w-none break-words"}):(0,s.jsx)("p",{className:"jsx-c56b0bdabd8066c1 whitespace-pre-wrap break-words",children:e.message}),(0,s.jsxs)("div",{className:`jsx-c56b0bdabd8066c1 text-[10px] mt-1 flex justify-end items-center space-x-1 opacity-50 ${r?"text-gray-700 dark:text-gray-300":"text-gray-500 dark:text-gray-400"}`,children:[(0,s.jsx)("span",{className:"jsx-c56b0bdabd8066c1",children:a}),r&&(0,s.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",className:"jsx-c56b0bdabd8066c1 w-3 h-3 text-blue-500",children:[(0,s.jsx)("path",{d:"M20 6L9 17l-5-5",className:"jsx-c56b0bdabd8066c1"}),(0,s.jsx)("path",{d:"M20 10l-11 11-5-5",className:"jsx-c56b0bdabd8066c1 translate-x-1"})]})]})]})},t)})]}),(0,s.jsx)("div",{className:"p-3 sm:p-4 bg-white/80 dark:bg-gray-800/80 backdrop-blur-md border-t border-gray-200/50 dark:border-gray-700/50 z-10 transition-all",children:(0,s.jsxs)("div",{className:"flex items-end space-x-2 max-w-full",children:[(0,s.jsx)("div",{className:"flex-1 bg-white dark:bg-[#2a3942] rounded-2xl shadow-sm border border-gray-200 dark:border-transparent focus-within:border-blue-500 transition-all flex items-end p-1",children:(0,s.jsx)("textarea",{value:K,onChange:e=>{Q(e.target.value),e.target.style.height="auto",e.target.style.height=Math.min(e.target.scrollHeight,120)+"px"},onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),K.trim()&&(eO(),e.target.style.height="auto"))},placeholder:"Type a message",className:"flex-1 px-3 py-2 bg-transparent text-sm text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none resize-none max-h-[120px]",rows:1})}),(0,s.jsx)("button",{onClick:()=>{eO();let e=document.querySelector('textarea[placeholder="Type a message"]');e&&(e.style.height="auto")},disabled:!K.trim(),className:`p-3 rounded-full flex items-center justify-center transition-all ${K.trim()?"bg-[#00a884] shadow-lg scale-100 hover:bg-[#008f72] active:scale-95":"bg-gray-300 dark:bg-gray-700 opacity-50 cursor-not-allowed scale-90"}`,children:(0,s.jsx)(k.A,{className:`w-5 h-5 text-white ${K.trim()?"translate-x-0.5 -translate-y-0.5":""}`})})]})})]})})]})]}),eg&&ex&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Monthly Limit Reached"}),(0,s.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["You've used ",ex.used," of ",ex.limit," free"," ","flashcards"===P?"flashcard sets":"courses"," this month."]}),(0,s.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:(0,s.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["Upgrade to Pro for unlimited"," ","flashcards"===P?"flashcards":"courses"," and premium features!"]})}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>{em(!1),eb(null)},className:"flex-1 px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Maybe Later"}),(0,s.jsx)("button",{onClick:()=>{em(!1),eb(null),t.push("/dashboard?tab=upgrade")},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Upgrade to Pro"})]})]})})})]}):(0,s.jsx)("div",{className:"h-[calc(100vh-6rem)] flex flex-col bg-gray-50 dark:bg-gray-900 overflow-hidden",children:(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"No course data available"})})})})}}},e=>{e.O(0,[3930,293,6609,8500,8991,8894,5333,6761,6788,9776,2261,8441,3794,7358],()=>e(e.s=65117)),_N_E=e.O()}]);