"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[913],{30913:(t,e,i)=>{i.d(e,{O5:()=>m,n$:()=>f,Iu:()=>w,D6:()=>F});var o=i(18831),r=i(28776),a=i(71876),l=i(82201),s=i.n(l);let n={primary:[37,99,235],primaryLight:[239,246,255],text:[31,41,55],textLight:[107,114,128],divider:[229,231,235]},c=async(t,e,o,r,a="File")=>{if(window.Capacitor||"capacitor:"===window.location.protocol)try{let l=t.output("datauristring").split(",")[1],{Filesystem:s,Directory:n}=await Promise.all([i.e(7805),i.e(8276)]).then(i.bind(i,78276)).catch(()=>({})),{Share:c}=await Promise.all([i.e(7805),i.e(8493)]).then(i.bind(i,98493)).catch(()=>({})),{LocalNotifications:h}=await Promise.all([i.e(7805),i.e(9968)]).then(i.bind(i,59968)).catch(()=>({}));try{let t=await s.requestPermissions();"granted"!==t.publicStorage&&console.warn("Storage permission not granted, falling back to app-specific storage.")}catch(t){}let d=await s.writeFile({path:e,data:l,directory:n.Downloads||n.Documents,recursive:!0});if(h)try{await h.schedule({notifications:[{title:"Download Successful",body:r||`The ${a.toLowerCase()} for "${o}" is ready.`,id:Math.floor(1e5*Math.random()),schedule:{at:new Date(Date.now()+500)},sound:null,attachments:[],smallIcon:"res://ic_stat_name",iconColor:"#2563EB"}]})}catch(t){console.error("[PDF] Notification error:",t)}if(c)try{await c.share({title:`${a} Downloaded`,text:`Successfully downloaded ${o}. Find it in your device's Downloads folder.`,url:d.uri,dialogTitle:"Share or Open Document"})}catch(t){console.error("[PDF] Share error:",t)}}catch(i){console.error("Capacitor PDF error (falling back to web save):",i),t.save(e)}else t.save(e)},h=(t,e,i)=>{t.setDrawColor(...n.divider),t.setLineWidth(.1),t.line(20,15,190,15),t.line(20,282,190,282),t.setFont("helvetica","normal"),t.setFontSize(8),t.setTextColor(...n.textLight);let o=new Date().getFullYear();t.text(`\xa9 ${o} Actinova AI Tutor - Premium Study Material`,20,287),t.text(`Page ${e} of ${i}`,190,287,{align:"right"})},d=(t,e,i)=>i+e>272?(t.addPage(),h(t,t.internal.getNumberOfPages(),t.internal.getNumberOfPages()),25):i,x=async(t,e,i,o,r,a=11,l)=>{let s=r-(i-20);t.setFontSize(a),t.setTextColor(...n.text);let c=e.trim().replace(/^[#\s]+/,"").replace(/\\\[(.*?)\\\]/g,"$1");if(!c)return o;let h=RegExp("(\\\\\\\\(?:[\\s\\S]*?)\\\\\\\\|\\$(?:[^$]+?)\\$|\\[.*?\\]\\(.*?\\)|`[^`]+`|\\*\\*.*?\\*\\*|__.*?__|(?<!\\*)\\*.*?\\*(?!\\*)|(?<!_)_.*?_(?!_)|~~.*?~~)","g"),d=c.split(h).filter(t=>t),x=[];for(let e of d){let i=e.match(/^(\\\(([\s\S]*?)\\\)|\$([^$]+?)\$)$/);if(i){let o=i[2]||i[3],r=await u(o.trim());if(r){let t=.3527*a*1.5,i=t*(r.width/r.height);x.push({type:"image",data:r.dataUrl,width:i,height:t,text:e})}else x.push({type:"text",text:e,width:t.getTextWidth(e)});continue}let o=e.match(/^\[(.*?)\]\((.*?)\)$/);if(o){let e=o[1],i=o[2];x.push({type:"link",text:e,url:i,width:t.getTextWidth(e)});continue}let r=e.match(/^`([^`]+)`$/);if(r){let e=r[1];t.setFont("courier","normal");let i=t.getTextWidth(e);t.setFont("helvetica","normal"),x.push({type:"code",text:e,width:i});continue}let l=e.startsWith("**")&&e.endsWith("**")||e.startsWith("__")&&e.endsWith("__"),s=e.startsWith("*")&&e.endsWith("*")||e.startsWith("_")&&e.endsWith("_"),n=e.startsWith("~~")&&e.endsWith("~~"),c=e;l?(c=e.slice(2,-2),t.setFont("helvetica","bold")):s?(c=e.slice(1,-1),t.setFont("helvetica","italic")):n&&(c=e.slice(2,-2)),t.getTextWidth(c),(l||s)&&t.setFont("helvetica","normal"),c.split(/(\s+)/).forEach(e=>{if(!e)return;let i=t.getTextWidth(e);x.push({type:"text",text:e,width:i,bold:l,italic:s,strike:n})})}let g=[],p=[],m=0;for(let t of x){if("\n"===t.text){g.push(p),p=[],m=0;continue}m+t.width>s?0===p.length?g.push([t]):(g.push(p),p=[t],m=t.width):(p.push(t),m+=t.width)}p.length>0&&g.push(p);let f=.3527*a*2;for(let e of g){o=l(t,f+2,o);let r=i;for(let i of e)"image"===i.type?t.addImage(i.data,"PNG",r,o-i.height+1,i.width,i.height):"code"===i.type?(t.setFont("courier","normal"),t.setFillColor(248,250,252),t.rect(r,o-a/1.5,i.width,a,"F"),t.setTextColor(220,38,38),t.text(i.text,r,o),t.setTextColor(...n.text),t.setFont("helvetica","normal")):"link"===i.type?(t.setTextColor(...n.primary),t.text(i.text,r,o),t.setDrawColor(...n.primary),t.setLineWidth(.1),t.line(r,o+1,r+i.width,o+1),t.link(r,o-a,i.width,a,{url:i.url}),t.setTextColor(...n.text)):(i.bold?t.setFont("helvetica","bold"):i.italic?t.setFont("helvetica","italic"):t.setFont("helvetica","normal"),t.text(i.text,r,o),i.strike&&(t.setDrawColor(...n.text),t.setLineWidth(.2),t.line(r,o-.25*a,r+i.width,o-.25*a)),t.setFont("helvetica","normal")),r+=i.width;o+=f}return o},g=async(t,e,i,o={})=>{let{margin:r=20,contentWidth:a=170,titleToSkip:l=null,isFirstLesson:s=!0}=o;if(!e)return i;let c=e.split("\n"),h=i,g=!1,m=[],f=[],w=[],F=[],C="",T=async()=>{if(0===F.length)return;let e=F.join(" ");h=await x(t,e,r,h,a,11,(e,i)=>d(t,e,i)),F=[]},y=async()=>{if(0===m.length)return;await T(),h=d(t,25,h)+5;let e=m.map(t=>t.split("|").map(t=>t.trim()).filter(t=>""!==t));if(e.length<2)return;let i=e[0],o=(a-10)/i.length;t.setFillColor(245,247,250),t.rect(r,h,a,10,"F"),t.setFont("helvetica","bold"),t.setFontSize(10),t.setTextColor(...n.text),i.forEach((e,i)=>t.text(e,r+5+i*o,h+6)),h+=10,t.setFont("helvetica","normal"),e.slice(2).forEach((e,i)=>{h=d(t,10,h),i%2==1&&(t.setFillColor(249,250,251),t.rect(r,h,a,10,"F")),e.forEach((e,i)=>{let a=t.splitTextToSize(e,o-5);t.text(a,r+5+i*o,h+6)}),t.setDrawColor(230,230,230),t.line(r,h+10,210-r,h+10),h+=10}),h+=5,m=[]};for(let e of c){let i=e.trim();if(!i&&!g){await T(),h+=6;continue}if(i.startsWith("```mermaid")){await y(),await T(),g="mermaid",f=[];continue}if("mermaid"===g&&i.startsWith("```")){g=!1;let e=f.join("\n");if(e.trim()){let i=await p(e);if(i){let e=i.width/3*.264583,o=i.height/3*.264583,l=e,s=o;if(l>a){let t=s/l;s=(l=a)*t}h=d(t,s+15,h),t.addImage(i.dataUrl,"PNG",r+(a-l)/2,h,l,s),h+=s+10}}continue}if("mermaid"===g){f.push(e);continue}if("$$"===i||"\\["===i){await y(),await T(),g="latex",w=[];continue}if("latex"===g&&("$$"===i||"\\]"===i)){g=!1;let e=w.join("\n");if(e.trim()){let i=await u(e);if(i){let e=.24*i.width,o=.24*i.height,l=e,s=o;if(l>a){let t=s/l;s=(l=a)*t}h=d(t,s+10,h),t.addImage(i.dataUrl,"PNG",r+5,h,l,s),h+=s+10}}continue}if("latex"===g){w.push(e);continue}if(i.startsWith("```")){await y(),await T(),g=!0!==g;continue}if(!0===g){h=d(t,8,h),t.setFont("courier","normal"),t.setFontSize(10),t.setFillColor(248,250,252),t.rect(r+2,h-4,a-4,6,"F"),t.text(e,r+4,h),h+=6;continue}if(i.startsWith("|")&&i.endsWith("|")){await T(),m.push(i);continue}if(await y(),(i.startsWith("# ")||i.startsWith("## "))&&(C=i.replace(/^#+\s*/,"").replace(/[\*_]/g,"").trim()),i.startsWith("#")&&!i.startsWith("# "),i.startsWith("# ")){await T();let e=i.substring(2).replace(/[\*_]/g,"").trim();if(l&&e.toLowerCase().includes(l.toLowerCase())&&s)continue;h+=5,t.setFont("helvetica","bold"),t.setFontSize(26),t.setTextColor(...n.primary),t.text(e,r,h),h+=5,t.setDrawColor(...n.primary),t.setLineWidth(.8),t.line(r,h-2,r+t.getTextWidth(e),h-2),h+=5}else if(i.startsWith("## ")){await T(),h+=5,t.setFont("helvetica","bold"),t.setFontSize(20),t.setTextColor(...n.primary);let e=i.substring(3).replace(/[\*_]/g,"").trim();t.text(e,r,h),h+=5,t.setDrawColor(...n.primaryLight),t.setLineWidth(.4),t.line(r,h-2,r+a,h-2),h+=4}else if(i.startsWith("### ")){await T(),h+=2.5,t.setFont("helvetica","bold"),t.setFontSize(16),t.setTextColor(...n.text);let e=i.substring(4).replace(/[\*_]/g,"").trim();t.text(e,r,h),h+=5}else if(i.startsWith("#### ")){await T(),h+=5/3,t.setFont("helvetica","bold"),t.setFontSize(13),t.setTextColor(...n.text);let e=i.substring(5).replace(/[\*_]/g,"").trim();t.text(e,r,h),h+=4}else if(i.startsWith("##### ")){await T(),h+=5/4,t.setFont("helvetica","bold"),t.setFontSize(11),t.setTextColor(...n.text);let e=i.substring(6).replace(/[\*_]/g,"").trim();t.text(e,r,h),h+=4}else if(i.startsWith("###### ")){await T(),h+=1,t.setFont("helvetica","bold"),t.setFontSize(10),t.setTextColor(...n.text);let e=i.substring(7).replace(/[\*_]/g,"").trim();t.text(e,r,h),h+=4}else if(i.startsWith("> ")){await T();let e=i.substring(2).trim();t.setFont("helvetica","italic"),t.setTextColor(...n.textLight);let o=t.splitTextToSize(e,a-15);h=d(t,8*o.length+5,h),t.setDrawColor(...n.primary),t.setLineWidth(1.5),t.line(r+2,h-4,r+2,h+8*o.length-4),o.forEach(e=>{t.text(e,r+8,h),h+=8}),h+=5}else if(i.match(/^[-*•]\s/))await T(),C.toLowerCase().includes("practice exercises")?(t.setFont("helvetica","bold"),t.setTextColor(0,0,0),t.text("✓",r+2,h),h=await x(t,i.replace(/^[-*•]\s/,""),r+10,h,a,11,(e,i)=>d(t,e,i))):(t.setFont("helvetica","bold"),t.setTextColor(...n.primary),t.text("•",r+2,h),h=await x(t,i.replace(/^[-*•]\s/,""),r+8,h,a,11,(e,i)=>d(t,e,i)));else if(i.match(/^\d+\.\s/)){await T();let e=i.match(/^\d+\./)[0];t.setFont("helvetica","bold"),t.setTextColor(...n.primary),t.text(e,r,h),h=await x(t,i.replace(/^\d+\.\s/,""),r+10,h,a,11,(e,i)=>d(t,e,i))}else e.startsWith("    ")||e.startsWith("	")?(await T(),h=await x(t,i,r+10,h,a,11,(e,i)=>d(t,e,i))):F.push(i)}return await y(),await T(),h},p=async t=>{try{let e=t.replace(/\[([\s\S]*?)\]/g,(t,e)=>/[()",]/.test(e)?`["${e.trim().replace(/"/g,'""')}"]`:t),i=`mermaid-pdf-${Date.now()}-${Math.floor(1e4*Math.random())}`;r.A.initialize({startOnLoad:!1,theme:"default"});let{svg:o}=await r.A.render(i,e);return new Promise(t=>{let e=new Image,i=btoa(unescape(encodeURIComponent(o))),r=`data:image/svg+xml;base64,${i}`;e.onload=()=>{let i=document.createElement("canvas");i.width=3*e.width,i.height=3*e.height;let o=i.getContext("2d");o.fillStyle="#ffffff",o.fillRect(0,0,i.width,i.height),o.scale(3,3),o.drawImage(e,0,0),t({dataUrl:i.toDataURL("image/png"),width:e.width,height:e.height})},e.onerror=()=>t(null),e.src=r})}catch(t){return console.error("Mermaid render error:",t),null}},u=async t=>{try{let e=document.createElement("div");e.style.position="absolute",e.style.left="-9999px",e.style.top="-9999px",e.style.padding="20px",e.style.backgroundColor="#ffffff",e.style.display="inline-block",document.body.appendChild(e),a.default.render(t,e,{throwOnError:!1,displayMode:!0,output:"html"});let i=await s()(e,{backgroundColor:"#ffffff",scale:3}),o=i.toDataURL("image/png");return document.body.removeChild(e),{dataUrl:o,width:i.width/3,height:i.height/3}}catch(t){return console.error("LaTeX render error:",t),null}},m=async t=>{if(!t)throw Error("No data provided");let e=new o.Ay({orientation:"portrait",unit:"mm",format:"a4"}),i=30;e.setFillColor(...n.primaryLight),e.rect(0,0,210,297,"F");try{e.addImage("/logo.png","PNG",80,i,50,50),i+=70}catch(t){i+=30}e.setFont("helvetica","bold"),e.setFontSize(40),e.setTextColor(...n.primary),e.text("ACTINOVA",105,i,{align:"center"}),i+=15,e.setFontSize(18),e.setTextColor(...n.textLight),e.text("AI Tutor Platform",105,i,{align:"center"}),i=140,e.setFillColor(255,255,255),e.setDrawColor(...n.primary),e.setLineWidth(2),e.roundedRect(20,i,170,80,10,10,"FD"),e.setTextColor(...n.primary),e.setFontSize(32);let r=e.splitTextToSize(t.title||"Full Course Material",130);e.text(r,105,i+30,{align:"center"}),e.setFontSize(14),e.setTextColor(...n.textLight),e.text("Personalized Course Textbook",105,i+60,{align:"center"}),e.text(`Generated: ${new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}`,105,i+75,{align:"center"}),e.addPage(),i=40;let a=t.modules||t.courseData?.modules||[];e.setFont("helvetica","bold"),e.setFontSize(28),e.setTextColor(...n.primary),e.text("Table of Contents",20,i),i+=20,a.forEach((t,o)=>{i=d(e,20,i),e.setFontSize(16),e.setTextColor(...n.text),e.text(`Module ${o+1}: ${t.title}`,20,i),i+=12,t.lessons&&t.lessons.forEach((t,r)=>{i=d(e,10,i),e.setFontSize(12),e.setTextColor(...n.textLight),e.text(`  ${o+1}.${r+1}  ${t.title||"Untitled Lesson"}`,25,i),i+=8}),i+=8});for(let t=0;t<a.length;t++){let o=a[t];e.addPage(),i=40,e.setFont("helvetica","bold"),e.setFontSize(34),e.setTextColor(...n.primary),e.text(`MODULE ${t+1}`,20,i),i+=18,e.setFontSize(24),e.setTextColor(...n.text);let r=e.splitTextToSize(o.title.toUpperCase(),170);if(e.text(r,20,i),i+=12*r.length+20,o.lessons)for(let r=0;r<o.lessons.length;r++){let a=o.lessons[r];i=d(e,50,i),e.setFont("helvetica","bold"),e.setFontSize(20),e.setTextColor(...n.primary);let l=`${t+1}.${r+1} ${a.title||"Lesson"}`,s=e.splitTextToSize(l,170);e.text(s,20,i),i+=10*s.length+15,a.content&&(i=await g(e,a.content,i,{titleToSkip:a.title,isFirstLesson:!0})),i+=20}}let l=e.getNumberOfPages();for(let t=1;t<=l;t++)e.setPage(t),h(e,t,l);let s=`${(t.title||"course").replace(/\s+/g,"_").toLowerCase()}.pdf`;await c(e,s,t.title,`Your full course textbook "${t.title}" is ready.`,"Course")},f=async t=>{if(!t||!t.content)throw Error("No content provided");let e=new o.Ay({orientation:"portrait",unit:"mm",format:"a4"}),i=25;e.setFillColor(255,255,255),e.rect(0,0,210,297,"F"),i=40;try{e.addImage("/logo.png","PNG",85,i,40,40),i+=45}catch(t){i=80}i+=16,e.setTextColor(...n.text),e.setFont("helvetica","bold"),e.setFontSize(40),e.text("STUDY NOTES",105,i,{align:"center"}),i=150;let r=e.splitTextToSize(t.title||"Lesson Material",130),a=40+12*r.length+20;e.setDrawColor(...n.primary),e.setLineWidth(.5),e.roundedRect(20,i-15,170,a,2,2,"D"),e.setTextColor(...n.primary),e.setFontSize(14),e.text("PERSONALIZED ACADEMIC CONTENT",105,i,{align:"center"}),i+=15,e.setTextColor(...n.text),e.setFontSize(28),e.text(r,105,i,{align:"center",maxWidth:130}),i+=12*r.length+10,e.setFontSize(12),e.setTextColor(...n.textLight),e.text(`Generated on ${new Date().toLocaleDateString()}`,105,i,{align:"center"}),e.addPage(),i=30,e.setFont("helvetica","bold"),e.setFontSize(22),e.setTextColor(...n.primary);let l=e.splitTextToSize(t.title||"Lesson Material",170);e.text(l,20,i),i+=8*l.length+6,i=await g(e,t.content,i,{titleToSkip:t.title,isFirstLesson:!0});let s=e.internal.pages.length-1;for(let t=1;t<=s;t++)e.setPage(t),h(e,t,s);let d=`${t.title?.replace(/\s+/g,"_").toLowerCase()||"lesson"}.pdf`;await c(e,d,t.title,"Your lesson notes are ready.","Lesson")},w=async t=>{if(!t||!t.questions)throw Error("No data provided");let e=new o.Ay({orientation:"portrait",unit:"mm",format:"a4"}),i=40,r=(i,o)=>{e.setDrawColor(...n.divider),e.setLineWidth(.1),e.line(20,15,190,15),e.setFontSize(8),e.setTextColor(...n.textLight),e.text(`Actinova AI Tutor - Assessment: ${t.title}`,20,12),i&&e.text(`Page ${i} of ${o}`,190,12,{align:"right"})};r(),e.setFont("helvetica","bold"),e.setFontSize(24),e.setTextColor(...n.primary),e.text("ASSESSMENT PAPER",105,i,{align:"center"}),i+=12,e.setFontSize(14),e.setTextColor(...n.textLight),e.text(`Subject: ${t.topic||"General Knowledge"}`,105,i,{align:"center"}),i+=20,t.questions.forEach((t,o)=>{let r=e.splitTextToSize(`${o+1}. ${t.text}`,160),a=8*(t.options?.length||0);i=d(e,6*r.length+a+20,i),e.setFont("helvetica","bold"),e.setFontSize(12),e.setTextColor(...n.text),e.text(r,20,i),i+=6*r.length+4,t.options&&(e.setFont("helvetica","normal"),e.setFontSize(11),t.options.forEach((t,o)=>{e.setTextColor(...n.textLight),e.text(String.fromCharCode(65+o)+")",25,i),e.setTextColor(...n.text),e.text(e.splitTextToSize(t,150),35,i),i+=8})),i+=6}),e.addPage(),r(),i=30,e.setFont("helvetica","bold"),e.setFontSize(18),e.setTextColor(...n.primary),e.text("ANSWER KEY",20,i),i+=15,e.setFontSize(11),t.questions.forEach((t,o)=>{i=d(e,10,i),e.setFont("helvetica","bold"),e.setTextColor(...n.text),e.text(`${o+1}: `,20,i),e.setFont("helvetica","normal"),e.setTextColor(...n.primary),e.text(String(t.correctAnswer),30,i),i+=10});let a=e.internal.pages.length-1;for(let t=1;t<=a;t++)e.setPage(t),r(t,a);let l=`assessment_${t.title?.replace(/\s+/g,"_").toLowerCase()||"exam"}.pdf`;await c(e,l,t.title,"Assessment downloaded successfully.","Assessment")},F=async(t,e="Scholar")=>{if(!t)throw Error("No data provided");let i=new o.Ay({orientation:"portrait",unit:"mm",format:"a4"}),r=30;i.setFontSize(70),i.setTextColor(240,240,240),i.text("ACTINOVA",105,160,{align:"center"});try{i.addImage("/logo.png","PNG",85,r,40,40),r+=55}catch(t){r+=10}i.setFillColor(...n.primary),i.rect(20,r,170,15,"F"),i.setFont("helvetica","bold"),i.setFontSize(18),i.setTextColor(255,255,255),i.text("PAYMENT RECEIPT",105,r+10,{align:"center"}),r+=30,i.setTextColor(...n.text),i.setFontSize(22),i.text("Actinova AI Tutor",105,r,{align:"center"}),r+=12,i.setFontSize(12),i.setTextColor(...n.textLight),i.text("Your Intelligent Learning Companion",105,r,{align:"center"}),r+=20,i.setFontSize(12),i.setTextColor(...n.text),i.text(`Billed to: ${e}`,105,r,{align:"center"}),r+=20,i.setFont("helvetica","bold"),i.setFontSize(16),i.text("Thank you for your subscription!",105,r,{align:"center"}),r+=25;let a=new Date(t.date||t.paidAt||Date.now()).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});i.setFontSize(11),i.setFont("helvetica","bold"),i.text("Date:",30,r),i.text(a,70,r),i.text("Plan:",115,r),i.text(t.plan||"Pro",145,r),r+=10,i.text("Receipt #:",30,r),i.text(t.reference?.toUpperCase()||"N/A",70,r),i.text("Status:",115,r),i.setTextColor(...n.success),i.text("PAID",145,r),r+=20,i.setFontSize(20),i.setTextColor(...n.primary);let l=new Intl.NumberFormat("en-US",{style:"currency",currency:t.currency||"USD"}).format(t.amount||0);i.text(`Amount: ${l}`,105,r,{align:"center"}),r+=30,i.setFontSize(10),i.setTextColor(...n.textLight),i.text("This is an official receipt. Contact support@actinova.ai for questions.",105,r,{align:"center"});let s=`receipt-${t.reference||"payment"}.pdf`;await c(i,s,"Subscription Payment","Your receipt has been downloaded.","Receipt")}}}]);